<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>HGAME_WEEK4_WP | R0gerThat</title><meta name="author" content="RT"><meta name="copyright" content="RT"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="HGAME WP">
<meta property="og:type" content="article">
<meta property="og:title" content="HGAME_WEEK4_WP">
<meta property="og:url" content="https://wr-web.github.io/2021/03/14/HGAME_WEEK4_WP/index.html">
<meta property="og:site_name" content="R0gerThat">
<meta property="og:description" content="HGAME WP">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.imgs.ovh/2023/10/15/r6rpC.jpeg">
<meta property="article:published_time" content="2021-03-14T12:00:00.000Z">
<meta property="article:modified_time" content="2023-10-15T07:40:07.140Z">
<meta property="article:author" content="RT">
<meta property="article:tag" content="WP">
<meta property="article:tag" content="HGAME">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.imgs.ovh/2023/10/15/r6rpC.jpeg"><link rel="shortcut icon" href="https://i.imgs.ovh/2023/10/13/XDJVK.jpeg"><link rel="canonical" href="https://wr-web.github.io/2021/03/14/HGAME_WEEK4_WP/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":300},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'HGAME_WEEK4_WP',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-10-15 15:40:07'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="R0gerThat" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.imgs.ovh/2023/10/13/XDQ7p.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">36</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">30</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.imgs.ovh/2023/10/15/r6rpC.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="R0gerThat"><span class="site-name">R0gerThat</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">HGAME_WEEK4_WP</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-03-14T12:00:00.000Z" title="发表于 2021-03-14 20:00:00">2021-03-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-10-15T07:40:07.140Z" title="更新于 2023-10-15 15:40:07">2023-10-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/HGAME/">HGAME</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>21分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="HGAME_WEEK4_WP"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="WEEK4-RogerThat-WP"><a href="#WEEK4-RogerThat-WP" class="headerlink" title="WEEK4-RogerThat WP"></a>WEEK4-RogerThat WP</h2><p>这周有点寒碜，只有三道题</p>
<h3 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h3><h4 id="vm"><a href="#vm" class="headerlink" title="vm"></a>vm</h4><p>这道题是一道虚拟机相关的题目，因此分许需要花不少时间，在没做出来之前也慢慢试着写点东西，希望也能有所收获。</p>
<p>首先寻找到main函数</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  FILE <span class="token operator">*</span>v3<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>v5<span class="token punctuation">;</span> <span class="token comment">// rcx</span>
  <span class="token keyword">char</span> Buffer<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+20h] [rbp-38h] BYREF</span>

  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Welcome to ovm++!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">j_inilization</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Input your flag: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v3 <span class="token operator">=</span> <span class="token function">_acrt_iob_func</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fgets</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> v3<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">j_printf_</span><span class="token punctuation">(</span><span class="token string">"Your flag is: %s\n"</span><span class="token punctuation">,</span> Buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"VM started successfully!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">j_vm_function</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__int64<span class="token punctuation">)</span><span class="token operator">&amp;</span>qword_7FF7ADCEE378<span class="token punctuation">,</span> <span class="token punctuation">(</span>__int64<span class="token punctuation">)</span>Buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v4 <span class="token operator">=</span> <span class="token function">memcmp</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_7FF7ADCEBD68<span class="token punctuation">,</span> <span class="token number">0x22u</span>i64<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v5 <span class="token operator">=</span> <span class="token string">"nop"</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>v4 <span class="token punctuation">)</span>
    v5 <span class="token operator">=</span> <span class="token string">"good"</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span>v5<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/breakpoints.jpg" alt="breakpoints"></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">#dialog
mov 83 to 000000B1524FF781
mov 46 to 000000B1524FF780
mov 23 to 000000B1524FF77F
mov 1 to 000000B1524FF77E
mov EC to 000000B1524FF77D
#.....
mov 90 to 000000B1524FF764
mov 75 to 000000B1524FF763
mov 5A to 000000B1524FF762
mov 39 to 000000B1524FF761
mov E9 to 000000B1524FF760
#一次循环加密
mov 9 to 000000B1524FF781
mov 2C to 000000B1524FF780
mov 69 to 000000B1524FF77F
mov A7 to 000000B1524FF77E
mov F2 to 000000B1524FF77D
#...
mov 3B to 000000B1524FF763
mov 80 to 000000B1524FF762
mov BF to 000000B1524FF761
mov CF to 000000B1524FF760
#第二次加密<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>大致可以得出是加密了两遍，把某一个值计算得到后移到对应位置，这个位置从最后一位到第一位再从最后一位到第一位，两次加密，得到结果</p>
<p>再进一步看看每个位置的结果是结果什么得到的</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">#第一次循环下
rdx:A
rdx:8
rdx:C
rdx:B
rdx:D
rdx:12
rdx:14
rdx:D
rdx:2&#x2F;&#x2F;different
rdx:13
rdx:7
rdx:15
rdx:C
rdx:11&#x2F;different
rdx:9
rdx:16
#第二次循环下
rdx:A
rdx:8
rdx:C
rdx:B
rdx:D
rdx:12
rdx:14
rdx:D
rdx:6 &#x2F;&#x2F;different
rdx:13
rdx:7
rdx:15
rdx:C
rdx:4 &#x2F;&#x2F;different
rdx:9
rdx:16<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-none"><code class="language-none">A:PUSH_BX
8:PUSH
C:POP_AX
B:PUSH_DX
D:POP_BX
12:CMP
14:JZ
D:POP_BX<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>由此可见A,8,C,B,D,12,14,D,2,13,7,15,C,11,9,16;这些 OPCODE 组成了一个加密的循环，而第一个嘛我也不清楚，总之它的结果是’{‘—&gt;?应该也不用太在意</p>
<p>通过对比两次输入的rdx流，发现这个关于每个字符是独立加密的，也就是缺少“扩散”的一种加密方法，虽然这样我更好做题目了，hhha</p>
<p>整理加密的伪代码之后得到如下结果</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">struct VM&#123;
        uint64_t *alloc_mem_pt;
        uint64_t *buffer_pt;
        uint8_t a;
        uint8_t x1;
        uint8_t x2;
        uint8_t x3;
        uint8_t x4;
        uint8_t b;
&#125;vm;

&#x2F;&#x2F;A:
    vm.x3 &#x3D; v8 + 1;
    *(_BYTE *)(vm.x3 + pt_of_memory) &#x3D; vm.x1;
    goto LABEL_32;
&#x2F;&#x2F;8:
    function();
    vm.x3 &#x3D; v8 + 1;
    *(_BYTE *)(vm.x3 + pt_of_memory) &#x3D; v2;

&#x2F;&#x2F;。。。。。。。。。。。。。
&#x2F;&#x2F;。。。。。。。。。。。。。
&#x2F;&#x2F;我的愚昧的伪代码，留在这警示一下我自己 &#x2F;吐血.jpg
    result &#x3D; *a1;
    v7 &#x3D; *a1 + 8 * v18;
    if ( !*(_BYTE *)(v7 + 4) )
        continue;

void function()&#123;
    v11 &#x3D; v5++;
    vm.x4 &#x3D; v5;
    v2 &#x3D; *(_BYTE *)(*a1 + 8 * v11);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>接下来思路就简单了，要么静态分析，要么动态调试一波，总之为了理解这个程序流不择手段2333<br>其实也可以分析汇编，不过估计伪代码应该比汇编简单一些</p>
<p>大意了，看出第一个循环是从后往前异或，没想到第二个循环变了.</p>
<p>这里吐槽一下我自己吧，伪代码已经那么诡异了，我为什么还要把伪代码修改成我自己的伪代码……………………………直接看ida的伪代码看熟悉了应该就可以了吧，如果真的要写成我自己的伪代码的话，估计得涉及到很多高级的重构方法了，要是真的能那么做的话，我也可以写个IDA了hhhha，所以结论就是我应该做不到</p>
<p>看出第一个阶段是异或，第二个阶段是减去莫个值，因此我们dump下来这个值就好了</p>
<p>上脚本</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">encrypted   <span class="token operator">=</span><span class="token string">b'\xCF\xBF\x80\x3B\xF6\xAF\x7E\x02\x24\xED\x70\x3A\xF4\xEB\x7A\x4A\xE7\xF7\xA2\x67\x17\xF0\xC6\x76\x36\xE8\xAD\x82\x2E\xDB\xB7\x4F\xE6\x09'</span>
xor_key     <span class="token operator">=</span><span class="token string">b'\xFE\x21\x44\x67\x8A\xAD\xD0\xF3\x16\x39\x5C\x7F\xA2\xC5\xE8\x0B\x2E\x51\x74\x97\xBA\xDD\x00\x23\x46\x69\x8C\xAF\xD2\xF5\x18\x3B\x5E\x81'</span>
decrease_key<span class="token operator">=</span><span class="token string">b'\x7A\x1A\xBA\x5A\xFA\x9A\x3A\xDA\x7A\x1A\xBA\x5A\xFA\x9A\x3A\xDA\x7A\x1A\xBA\x5A\xFA\x9A\x3A\xDA\x7A\x1A\xBA\x5A\xFA\x9A\x3A\xDA\x7A\x1A'</span>
decrypted   <span class="token operator">=</span><span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    temp_num <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>encrypted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token builtin">int</span><span class="token punctuation">(</span>decrease_key<span class="token punctuation">[</span><span class="token number">33</span><span class="token operator">-</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    temp_num <span class="token operator">&amp;</span><span class="token operator">=</span> <span class="token number">0xFF</span>
    temp_num <span class="token operator">^</span><span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>xor_key<span class="token punctuation">[</span><span class="token number">33</span><span class="token operator">-</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    decrypted <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>temp_num<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>decrypted<span class="token punctuation">)</span>
<span class="token comment">#decrypted = “hgame&#123;w0W!itS_CpP_wItH_little_vM!&#125;”</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>看来还有好多可以琢磨的了，怪不得这道题有人做这么快。这个虚拟机的指令真的不是简单的指令，我本来以为是相当于push,pop这种，最后想一下应该是相当于一个函数了，然后又因为一些交叉的变量看起来比较复杂，这点看来很值得思考了。</p>
<p>x64日志dump挺好用的，<a target="_blank" rel="noopener" href="https://help.x64dbg.com/en/latest/introduction/Formatting.html">https://help.x64dbg.com/en/latest/introduction/Formatting.html</a></p>
<h4 id="nllvm"><a href="#nllvm" class="headerlink" title="nllvm"></a>nllvm</h4><p>虽说和 llvm 和 ollvm 有一定关系，但是这个混淆只是单纯的增长，程序流并没有混淆</p>
<p>根据程序流，或者根据加密过程中 <strong>sbox</strong> ，可以判断出是 aes ，但是是不是 aes 变种呢，由于我对aes-256 cbc 有所误解，以为key的长度不能是 64 字节，导致我只好手撸这道题，不过想来，如果这样子的话我以后就能对付变种了，虽然。。。建立在我被自己坑的基础上。</p>
<p>不过由于是数论的东西，我也要mark一下。在 GF(2^8) 域上，加法和乘法不是我们一般的域的加法，乘法则需要左移一位，然后再判断正负,乘以 0x1b 之类，正如下面的 Multiply 宏定义。而 xtime 是用于乘法，详细的见<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Jeely/p/11724506.html%EF%BC%8C%E5%85%B6%E5%AE%9E%E6%89%8B%E6%92%B8">https://www.cnblogs.com/Jeely/p/11724506.html，其实手撸</a> aes 我觉得还是挺有价值的。因为我大一下 hgame 中也做过一道，那道我是用代码辅助手算得到的 flag ，痛苦得很。。。不过感觉数论好重要啊。。。可能我是一个密码手 2333</p>
<p>如果要复现的话一种可能就是用宏函数，在没有什么优化的情况下应该是能让函数如此之长，还有一种就是使用一些混淆的工具，如 ollvm 这种，这种应该就要调试分析了。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdint.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">Multiply</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>                                </span><span class="token punctuation">\</span>
      <span class="token expression"><span class="token punctuation">(</span>  <span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> x<span class="token punctuation">)</span> <span class="token operator">^</span>                              </span><span class="token punctuation">\</span>
      <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token operator">>></span><span class="token number">1</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">xtime</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span>                       </span><span class="token punctuation">\</span>
      <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token operator">>></span><span class="token number">2</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">xtime</span><span class="token punctuation">(</span><span class="token function">xtime</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span>                </span><span class="token punctuation">\</span>
      <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token operator">>></span><span class="token number">3</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">xtime</span><span class="token punctuation">(</span><span class="token function">xtime</span><span class="token punctuation">(</span><span class="token function">xtime</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span>         </span><span class="token punctuation">\</span>
      <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token operator">>></span><span class="token number">4</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">xtime</span><span class="token punctuation">(</span><span class="token function">xtime</span><span class="token punctuation">(</span><span class="token function">xtime</span><span class="token punctuation">(</span><span class="token function">xtime</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   </span><span class="token punctuation">\</span>
</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">uint8_t</span> rsbox<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd5</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9e</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xf3</span><span class="token punctuation">,</span> <span class="token number">0xd7</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span>
        <span class="token number">0x7c</span><span class="token punctuation">,</span> <span class="token number">0xe3</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0x9b</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0x8e</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0xc4</span><span class="token punctuation">,</span> <span class="token number">0xde</span><span class="token punctuation">,</span> <span class="token number">0xe9</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span>
        <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x7b</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0x3d</span><span class="token punctuation">,</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xc3</span><span class="token punctuation">,</span> <span class="token number">0x4e</span><span class="token punctuation">,</span>
        <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x2e</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0xb2</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x5b</span><span class="token punctuation">,</span> <span class="token number">0xa2</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x6d</span><span class="token punctuation">,</span> <span class="token number">0x8b</span><span class="token punctuation">,</span> <span class="token number">0xd1</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span>
        <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xf8</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xa4</span><span class="token punctuation">,</span> <span class="token number">0x5c</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0xb6</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span>
        <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0xfd</span><span class="token punctuation">,</span> <span class="token number">0xed</span><span class="token punctuation">,</span> <span class="token number">0xb9</span><span class="token punctuation">,</span> <span class="token number">0xda</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0xa7</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span>
        <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x8c</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0xb8</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span>
        <span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x1e</span><span class="token punctuation">,</span> <span class="token number">0x8f</span><span class="token punctuation">,</span> <span class="token number">0xca</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0x0f</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0xc1</span><span class="token punctuation">,</span> <span class="token number">0xaf</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span>
        <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0xea</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0xf2</span><span class="token punctuation">,</span> <span class="token number">0xcf</span><span class="token punctuation">,</span> <span class="token number">0xce</span><span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0xb4</span><span class="token punctuation">,</span> <span class="token number">0xe6</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span>
        <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0xac</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0xe7</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0xe2</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0x1c</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0xdf</span><span class="token punctuation">,</span> <span class="token number">0x6e</span><span class="token punctuation">,</span>
        <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0xf1</span><span class="token punctuation">,</span> <span class="token number">0x1a</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0xb7</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span>
        <span class="token number">0xfc</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x3e</span><span class="token punctuation">,</span> <span class="token number">0x4b</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0xd2</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0xdb</span><span class="token punctuation">,</span> <span class="token number">0xc0</span><span class="token punctuation">,</span> <span class="token number">0xfe</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0xcd</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0xf4</span><span class="token punctuation">,</span>
        <span class="token number">0x1f</span><span class="token punctuation">,</span> <span class="token number">0xdd</span><span class="token punctuation">,</span> <span class="token number">0xa8</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0xc7</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0xb1</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xec</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span>
        <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x7f</span><span class="token punctuation">,</span> <span class="token number">0xa9</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0xb5</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span> <span class="token number">0xe5</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0xc9</span><span class="token punctuation">,</span> <span class="token number">0x9c</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span>
        <span class="token number">0xa0</span><span class="token punctuation">,</span> <span class="token number">0xe0</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0x2a</span><span class="token punctuation">,</span> <span class="token number">0xf5</span><span class="token punctuation">,</span> <span class="token number">0xb0</span><span class="token punctuation">,</span> <span class="token number">0xc8</span><span class="token punctuation">,</span> <span class="token number">0xeb</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0x3c</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span>
        <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0x2b</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x7e</span><span class="token punctuation">,</span> <span class="token number">0xba</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0xd6</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token number">0x7d</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">uint8_t</span> const_key<span class="token punctuation">[</span><span class="token number">257</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"\x43\x72\x79\x70\x74\x6F\x46\x41\x49\x4C\x55\x52\x45\x66\x6F\x72"</span>
                                 <span class="token string">"\x52\x53\x41\x32\x30\x34\x38\x4B\x65\x79\x21\x21\x21\x21\x21\x21"</span>
                                 <span class="token string">"\xBF\x8F\x84\x8D\xCB\xE0\xC2\xCC\x82\xAC\x97\x9E\xC7\xCA\xF8\xEC"</span>
                                 <span class="token string">"\x94\x27\x00\xFC\xA4\x13\x38\xB7\xC1\x6A\x19\x96\xE0\x4B\x38\xB7"</span>
                                 <span class="token string">"\x0E\x88\x2D\x6C\xC5\x68\xEF\xA0\x47\xC4\x78\x3E\x80\x0E\x80\xD2"</span>
                                 <span class="token string">"\x59\x8C\xCD\x49\xFD\x9F\xF5\xFE\x3C\xF5\xEC\x68\xDC\xBE\xD4\xDF"</span>
                                 <span class="token string">"\xA4\xC0\xB3\xEA\x61\xA8\x5C\x4A\x26\x6C\x24\x74\xA6\x62\xA4\xA6"</span>
                                 <span class="token string">"\x7D\x26\x84\x6D\x80\xB9\x71\x93\xBC\x4C\x9D\xFB\x60\xF2\x49\x24"</span>
                                 <span class="token string">"\x25\xFB\x85\x3A\x44\x53\xD9\x70\x62\x3F\xFD\x04\xC4\x5D\x59\xA2"</span>
                                 <span class="token string">"\x61\x6A\x4F\x57\xE1\xD3\x3E\xC4\x5D\x9F\xA3\x3F\x3D\x6D\xEA\x1B"</span>
                                 <span class="token string">"\x09\x7C\x2A\x1D\x4D\x2F\xF3\x6D\x2F\x10\x0E\x69\xEB\x4D\x57\xCB"</span>
                                 <span class="token string">"\x88\x89\x14\x48\x69\x5A\x2A\x8C\x34\xC5\x89\xB3\x09\xA8\x63\xA8"</span>
                                 <span class="token string">"\xEB\x87\xE8\x1C\xA6\xA8\x1B\x71\x89\xB8\x15\x18\x62\xF5\x42\xD3"</span>
                                 <span class="token string">"\x22\x6F\x38\x2E\x4B\x35\x12\xA2\x7F\xF0\x9B\x11\x76\x58\xF8\xB9"</span>
                                 <span class="token string">"\xC1\xC6\xBE\x24\x67\x6E\xA5\x55\xEE\xD6\xB0\x4D\x8C\x23\xF2\x9E"</span>
                                 <span class="token string">"\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0A\x0B\x0C\x0D\x0E\x0F"</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">uint8_t</span> const_iv<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0A\x0B\x0C\x0D\x0E\x0F"</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">uint8_t</span> const_data<span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"\x91\xB3\xC1\xEB\x14\x5D\xD5\xCE\x3A\x1D\x30\xE4\x70\x6C\x6B\xD7"</span>
                                      <span class="token string">"\x69\x78\x79\x02\xA3\xA5\xDF\x1B\xFD\x1C\x02\x89\x14\x20\x7A\xFD"</span>
                                      <span class="token string">"\x24\x52\xF8\xA9\xF9\xF1\x6B\x1C\x0F\x5D\x50\x5B\xEC\x42\xD1\x8C"</span>
                                      <span class="token string">"\xB8\x12\xCF\x2C\xA9\x69\x31\x46\xFD\x9B\xEA\xDE\xC8\xBF\x94\x69"</span><span class="token punctuation">;</span>
<span class="token comment">//                                        "\x92\x16\x48\xBB\x9F\x81\xE0\x47\x7D\xEB\x40\x70\x07\x9E\x2A\x87"</span>
<span class="token comment">//                                      "\x87\xC4\x00\xCB\x2F\xC2\x09\x4C\x9E\x4B\x72\xC6\x84\xDE\x54\x7E"</span>
<span class="token comment">//                                      "\xAB\x5A\xB8\x46\x0A\xBD\x04\x1E\xFE\x62\x0A\xCC\xFB\xA0\x99\xA5"</span>
<span class="token comment">//                                      "\xA2\x83\xF4\x83\x64\x6C\xC1\xE5\xD2\x37\x9E\xC9\x9D\xF0\x28\x6C";</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">InvMixRows</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token class-name">uint8_t</span> <span class="token function">xtime</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">xorKey</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span>state<span class="token punctuation">,</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">invColShift</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token operator">*</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">invSbox</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token operator">*</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">uint8_t</span> iv<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span>key<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">memcpy</span><span class="token punctuation">(</span>iv<span class="token punctuation">,</span>const_iv<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">memcpy</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>const_key<span class="token punctuation">,</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">memcpy</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>const_data<span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>j <span class="token operator">&lt;</span> <span class="token number">14</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token function">xorKey</span><span class="token punctuation">(</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">,</span>key<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token operator">-</span>j<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token function">InvMixRows</span><span class="token punctuation">(</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">invColShift</span><span class="token punctuation">(</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">invSbox</span><span class="token punctuation">(</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token function">xorKey</span><span class="token punctuation">(</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">-</span>i<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token function">xorKey</span><span class="token punctuation">(</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">,</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            <span class="token function">xorKey</span><span class="token punctuation">(</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">,</span>iv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">(</span>data<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token comment">//    uint8_t test[4][4] = &#123;0&#125;;</span>
<span class="token comment">//    test[0][0] = 0xF1^0x72^0xEB^xtime(0x77^0xF1);</span>
<span class="token comment">//    test[0][1] = 0x77^0x72^0xEB^xtime(0xF1^0x72);</span>
<span class="token comment">//    test[0][2] = 0x77^0xF1^0xEB^xtime(0x72^0xEB);</span>
<span class="token comment">//    test[0][3] = 0x77^0xF1^0x72^xtime(0xEB^0x77);</span>
<span class="token comment">//    InvMixRows((uint8_t*)test);</span>


    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">xorKey</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span>state<span class="token punctuation">,</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span>i<span class="token punctuation">)</span> <span class="token operator">^=</span> <span class="token operator">*</span><span class="token punctuation">(</span>key<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">invColShift</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token operator">*</span>state<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token class-name">uint8_t</span> a   <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">uint8_t</span> b1  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">uint8_t</span> b2  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">uint8_t</span> c   <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">9</span><span class="token punctuation">)</span>  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token operator">=</span> a<span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">=</span> b1<span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">)</span>  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">14</span><span class="token punctuation">)</span> <span class="token operator">=</span> b2<span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">7</span><span class="token punctuation">)</span>  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">invSbox</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token operator">*</span> state<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> rsbox<span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">InvMixRows</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span>state<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token class-name">int8_t</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        a <span class="token operator">=</span> <span class="token punctuation">(</span>__int8<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        b <span class="token operator">=</span> <span class="token punctuation">(</span>__int8<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        c <span class="token operator">=</span> <span class="token punctuation">(</span>__int8<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        d <span class="token operator">=</span> <span class="token punctuation">(</span>__int8<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">)</span>     <span class="token operator">=</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">static</span> <span class="token class-name">uint8_t</span> <span class="token function">xtime</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> x<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">>></span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0x1b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//hgame&#123;cOsm0s_is_still_fight1ng_and_NEVER_GIVE_UP_O0o0o0oO00o00o&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="A-5-Second-Challenge"><a href="#A-5-Second-Challenge" class="headerlink" title="A 5 Second Challenge"></a>A 5 Second Challenge</h4><p>il2cpp逆向题目，没想到我技能树点歪了</p>
<p>先上图：<br>听说你叫扫雷的.jpg<br><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/YouLoser.png" alt="YouLoser"></p>
<p>其实我玩扫雷很菜，但是炸弹炸不死我 2333<br>为了破解这个东西，我干了好多活，最累的其实是点开 💣，再其次是画二维码。</p>
<p>那我现在从头开始讲。</p>
<p>由于开始时对unity的一些文件配置完全不懂，导致我看的晕头转向。不过看了别人逆向的一些实例，我大概理解了文件结构。那我写长一点，从启动函数开始。</p>
<p>众所周知为了玩游戏，点开了游戏，但是游戏 .exe 里面其实并没有游戏的逻辑<br><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/unityMain.jpg" alt="unityMain"></p>
<p>直接跳转到了 UnityMain 函数中，而这个函数在别的 dll 中，我们可以打开 PE-bear 其实也可以自己对着节区去看，不过算起来比较复杂，有现成的工具用一下也挺好</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/UnityMain_2.jpg" alt="UnityMain_2"></p>
<p>然后我们就开始对 UnityPlayer 释放魔法（动态调试），发现 UnityPlayer 其实是通过 CreatWindowExW 创建句柄，传递给 showWindow，最终打开 unity 窗口。其中 sub0x180547E70 可以称为 Load_Game_function （我自己这么定义的 233 ）</p>
<p>其中 sub_180088310 函数常用于检测或者加载是否加载成功一些文件，比如 app.info , config , Play.log 等文件，但是我们仍然找不到游戏逻辑，继续追踪发现在</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/gameAssembly.jpg" alt="gameAssembly"></p>
<p>此处加载了 GameAssembly.dll 加载成功后会 继续加载一些文件比如 $(game)&#x2F;game_data&#x2F;il2cpp_data&#x2F;etc , 再后来也会加载一些 creen 相关的模块 ，不顾哦这个我也不懂 ，过了一段函数，会加载一堆 dll ，最后就是打开窗口 showWindow . 再进一步就可以调试 GameAssembly.dll 结合网上所说，GameAssembly.dll 中包含着游戏的逻辑，我对他就更加期待了起来。</p>
<p>打开会发现很多名为 il2cpp_XXX_XXX_XXX 的函数，查阅一些别人的博客，再加自己的动态调试，加看 IL 源码 ，我也稍微理解了一些il2cpp_xxx 函数的作用 ，因为是从 C# -&gt; CPP -&gt; PE 他面向对象的方法，思想也就变成了 il2cpp_xxx 的一些函数，而在 il2cpp 源码中比如这一段</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// System.Boolean AFiveSecondChallenge.BombChecker::CheckIfExpired()</span>
IL2CPP_EXTERN_C IL2CPP_METHOD_ATTR <span class="token keyword">bool</span> <span class="token function">BombChecker_CheckIfExpired_m11965D79AB8C709FB9F999ACFFA108438A43652E</span> <span class="token punctuation">(</span><span class="token keyword">const</span> RuntimeMethod<span class="token operator">*</span> method<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">static</span> <span class="token keyword">bool</span> s_Il2CppMethodInitialized<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>s_Il2CppMethodInitialized<span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">il2cpp_codegen_initialize_method</span> <span class="token punctuation">(</span>BombChecker_CheckIfExpired_m11965D79AB8C709FB9F999ACFFA108438A43652E_MetadataUsageId<span class="token punctuation">)</span><span class="token punctuation">;</span>
		s_Il2CppMethodInitialized <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">IL2CPP_RUNTIME_CLASS_INIT</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int64_t</span> L_0 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_StaticFields<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_static_fields_for</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">get_firstQueryTime_4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>L_0<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">goto</span> IL_001b<span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">IL2CPP_RUNTIME_CLASS_INIT</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int64_t</span> L_1 <span class="token operator">=</span> <span class="token function">BombChecker_GetNowUnixTime_m02658B00EEC2CD986B3894FB392B39BB186716A8</span><span class="token punctuation">(</span><span class="token comment">/*hidden argument*/</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int64_t</span> L_2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_StaticFields<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_static_fields_for</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">get_firstQueryTime_4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int32_t</span> L_3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_StaticFields<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_static_fields_for</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">get_expireIn_5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">bool</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int64_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int64_t</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_subtract</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int64_t</span><span class="token punctuation">)</span>L_1<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int64_t</span><span class="token punctuation">)</span>L_2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int64_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int64_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int64_t</span><span class="token punctuation">)</span>L_3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
    
IL_001b<span class="token operator">:</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">bool</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>每次调用一些函数之前一般会使用 il2cpp_runtime_class_init （猜测是创建对象），然后使用 il2cpp_substract_xxx 等函数实现对对象的操作，非常奇妙的感觉，由此可以看出 <strong>只要我们在 il2cpp_runtime_class_init 下断点，我们就能知道 CheckIfExpired，通过交叉引用能找到</strong>。</p>
<p>上面所说不失为一种方法，但是事实是，即使是调试到 只有点击地雷才会 碰到断点的时候，通过条件断点，日志，我们能发现 调用了 15次 il2cpp_runtime_class_init 而从一开始运行的话调用了将近 50 次 所以通过这个方法 我们往往会偏离目标，而且找到函数之后 我们还要根据函数的逻辑去比对 il2cpp 源码 实在是离谱。由此 我们引入老大哥。 <em><strong>global-metadata.dat</strong></em></p>
<p>这个文件记载了一些被调用的字符串，还有函数名以及 偏移，这个文件有一个结构体，其实可以mark一下</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">struct</span> <span class="token class-name">Il2CppGlobalMetadataHeader</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name">int32_t</span> sanity<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> version<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> stringLiteralOffset<span class="token punctuation">;</span> <span class="token comment">// string data for managed code</span>
    <span class="token class-name">int32_t</span> stringLiteralCount<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> stringLiteralDataOffset<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> stringLiteralDataCount<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> stringOffset<span class="token punctuation">;</span> <span class="token comment">// string data for metadata</span>
    <span class="token class-name">int32_t</span> stringCount<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> eventsOffset<span class="token punctuation">;</span> <span class="token comment">// Il2CppEventDefinition</span>
    <span class="token class-name">int32_t</span> eventsCount<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> propertiesOffset<span class="token punctuation">;</span> <span class="token comment">// Il2CppPropertyDefinition</span>
    <span class="token class-name">int32_t</span> propertiesCount<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> methodsOffset<span class="token punctuation">;</span> <span class="token comment">// Il2CppMethodDefinition</span>
    <span class="token class-name">int32_t</span> methodsCount<span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>然后通过调试得知，估计这个 Metadata 文件是在 UnityPlayer.dll 中载入的，反之我们也能从中读取到一些东西，甚至网上已经有了可以 dump Metadata 的工具 Il2cppDumper<br>hint 2: il2cpp 中间文件（源码）已经直接给了，就不太需要用 il2cppdumper 这类工具去死怼 GameAssembly.dll 了 囧</p>
<p>其实我不知道魔法少女为什么会给这个hint，估计是担心我们白怼 GameAssembly.dll ，其实正常的思路应该是去解密那个地雷矩阵，不过我一脑子扎进去就没停下来，最后造成这个结局 233。（其实 IL2CPP 读起来有点反人类，括号太多了，看着就烦…）其实这里有一个小 Tip 待会儿再讲</p>
<p>通过 Il2cppDumper 我们可以得到源码的 dll , 不过并没有具体的内容，大多只是有 偏移地址之类的 ，不过这样也足够了</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/dump.jpg" alt="dump"></p>
<p>再通过 dnspy 打开 这个dll</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/new.jpg" alt="new"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/old.jpg" alt="old"></p>
<p>两个对比很明显 我们得到了函数地址 ，最后就开始了魔改环节 。</p>
<p>这个环节试错比较多，我也慢慢讲</p>
<p>在 CS_Mouse_Brick 函数中我们会发现 是否发现炸弹的两条分路</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/first.jpg" alt="first"></p>
<p>而在此之前我们会先检测一遍时间，我当场就把他的对我不好的逻辑 给 nop 掉了</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/firstNop.jpg" alt="firstNop"></p>
<p>只改了这一处 会发现 时间过了之后，不管点什么 他都是炸弹！ 动调了一下 发现了原因</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/second_change.jpg" alt="second_change"></p>
<p>这一段在 CheckBombAt 函数中 ，检测到超时之后，这里本来会指向别的地方，最终造成 点啥都是炸弹，我就把这里两个逻辑都汇聚在一起，这样这俩就都是魔法少女了。</p>
<p>最后我们还需修改一处，就是当程序发现你点了雷，他就会终止你接下来的行为。</p>
<p>而这个逻辑是在<br><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/final_change.jpg" alt="final_change"></p>
<p>如果要退出他会置 1 那我反过来不让他退出，所以我就置 0；最后就成功地劫持了程序流</p>
<p>话说我刚才说了 （劫持） 。。。我这明明是 （抢劫）</p>
<p>pwn里面改不了程序流，大多通过溢出来劫持，因此称我这个为 （抢劫） 一点不过分。</p>
<p>然后就是手酸的点地雷了 233 ，再是手酸的绘制 二维码了</p>
<p>最后结果</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/YouLoser0.png" alt="YouLoser"></p>
<p>其实只要缩小一下就能扫出来，还好二维码可以有误差，不然我只好裂开。</p>
<p>手~~~好酸啊，我下次一定去看矩阵。。。</p>
<p>好了，最后我再收回我说的 Tip 我们看回 il2cpp 的源码</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">&#123;</span>
	<span class="token function">IL2CPP_RUNTIME_CLASS_INIT</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">;</span>
	DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span> L_3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_StaticFields<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_static_fields_for</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">get_matrix_6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Vector2_tA85D2DD88578276CA8A8796756458277E72D073D  L_4 <span class="token operator">=</span> ___vec0<span class="token punctuation">;</span>
	<span class="token keyword">float</span> L_5 <span class="token operator">=</span> L_4<span class="token punctuation">.</span><span class="token function">get_y_1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Vector2_tA85D2DD88578276CA8A8796756458277E72D073D  L_6 <span class="token operator">=</span> ___vec0<span class="token punctuation">;</span>
	<span class="token keyword">float</span> L_7 <span class="token operator">=</span> L_6<span class="token punctuation">.</span><span class="token function">get_x_0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">NullCheck</span><span class="token punctuation">(</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span>L_3<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_8 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span>L_3<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">GetAt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span>L_5<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span>L_7<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span> L_9 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_StaticFields<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_static_fields_for</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">get_matrix_6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Vector2_tA85D2DD88578276CA8A8796756458277E72D073D  L_10 <span class="token operator">=</span> ___vec0<span class="token punctuation">;</span>
	<span class="token keyword">float</span> L_11 <span class="token operator">=</span> L_10<span class="token punctuation">.</span><span class="token function">get_y_1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Vector2_tA85D2DD88578276CA8A8796756458277E72D073D  L_12 <span class="token operator">=</span> ___vec0<span class="token punctuation">;</span>
	<span class="token keyword">float</span> L_13 <span class="token operator">=</span> L_12<span class="token punctuation">.</span><span class="token function">get_x_0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">NullCheck</span><span class="token punctuation">(</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span>L_9<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_14 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span>L_9<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">GetAt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span>L_11<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span>L_13<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	V_0 <span class="token operator">=</span> L_14<span class="token punctuation">;</span>
	DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span> L_15 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_StaticFields<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_static_fields_for</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">get_matrix_6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Vector2_tA85D2DD88578276CA8A8796756458277E72D073D  L_16 <span class="token operator">=</span> ___vec0<span class="token punctuation">;</span>
	<span class="token keyword">float</span> L_17 <span class="token operator">=</span> L_16<span class="token punctuation">.</span><span class="token function">get_y_1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Vector2_tA85D2DD88578276CA8A8796756458277E72D073D  L_18 <span class="token operator">=</span> ___vec0<span class="token punctuation">;</span>
	<span class="token keyword">float</span> L_19 <span class="token operator">=</span> L_18<span class="token punctuation">.</span><span class="token function">get_x_0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">NullCheck</span><span class="token punctuation">(</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span>L_15<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_20 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span>L_15<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">GetAt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span>L_17<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span>L_19<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	V_1 <span class="token operator">=</span> L_20<span class="token punctuation">;</span>
	Vector2_tA85D2DD88578276CA8A8796756458277E72D073D  L_21 <span class="token operator">=</span> ___vec0<span class="token punctuation">;</span>
	<span class="token keyword">float</span> L_22 <span class="token operator">=</span> L_21<span class="token punctuation">.</span><span class="token function">get_x_0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	V_2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_subtract</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">fmodf</span><span class="token punctuation">(</span>L_22<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3.0f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1.0f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_23 <span class="token operator">=</span> V_2<span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_24 <span class="token operator">=</span> V_2<span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_25 <span class="token operator">=</span> V_0<span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_26 <span class="token operator">=</span> V_2<span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_27 <span class="token operator">=</span> V_1<span class="token punctuation">;</span>
       <span class="token comment">//此注释没什么用，请忽略</span>
	<span class="token comment">//		L_8*L_23*L_24+L_25*L_26+L_27</span>
	<span class="token comment">// L_8  = GetAt(y1,x0/3,0)</span>
	<span class="token comment">// L_23 = x0 fmodf 3 -1</span>
	<span class="token comment">// L_24 = x0 fmodf 3 -1</span>
	<span class="token comment">// L_25 = GetAt(y1,x0/3,1)</span>
	<span class="token comment">// L_26 = x0 fmodf 3 -1</span>
	<span class="token comment">// L_27 = GetAt(y1,x0/3,1)</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">bool</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_multiply</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_multiply</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>L_8<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>L_23<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>L_24<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_multiply</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>L_25<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>L_26<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>L_27<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>我们可以很快发现这个是判断是否是地雷的源码，但是很明显，这也太难看懂了，因此我建议，以后反调试，只要把 cpp -&gt; c# -&gt; il -&gt; cpp 就好了，保证大部分人看裂开，但是我们其实这里有另外一种思维，源码看不懂，那看逆向 出来的 伪代码 呗。</p>
<p>ida 中可以有</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">return</span> v9 <span class="token operator">*</span> v11 <span class="token operator">*</span> v11 <span class="token operator">+</span> v11 <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v2 <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">*</span> v10 <span class="token operator">+</span> <span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v2 <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">*</span> v10 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0.0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>我们再结合起来看其实就方便了很多。</p>
<p>经过测试分析，最后写出脚本<br>其中 data.py 存储着从 AFiveSecondChallenge.dll 中的一个数组结构 matrix[45][15][3]</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> data

x_matrix <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
y_matrix <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
matrix <span class="token operator">=</span> data<span class="token punctuation">.</span>matrix
<span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> matrix<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token operator">//</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>x<span class="token operator">%</span><span class="token number">3</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> matrix<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token operator">//</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>x<span class="token operator">%</span><span class="token number">3</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> matrix<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token operator">//</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
            x_matrix<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
            y_matrix<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x_matrix<span class="token punctuation">,</span>y_matrix<span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span>marker <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/QRCODE.jpg" alt="QRCODE"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://wr-web.github.io">RT</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://wr-web.github.io/2021/03/14/HGAME_WEEK4_WP/">https://wr-web.github.io/2021/03/14/HGAME_WEEK4_WP/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wr-web.github.io" target="_blank">R0gerThat</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WP/">WP</a><a class="post-meta__tags" href="/tags/HGAME/">HGAME</a></div><div class="post_share"><div class="social-share" data-image="https://i.imgs.ovh/2023/10/15/r6rpC.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/03/14/HGAME_WEEK2_WP/" title="HGAME_WEEK2_WP"><img class="cover" src="https://i.imgs.ovh/2023/10/15/r6F8m.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">HGAME_WEEK2_WP</div></div></a></div><div class="next-post pull-right"><a href="/2021/03/14/HGAME_WEEK1_WP/" title="HGAME_WEEK1_WP"><img class="cover" src="https://i.imgs.ovh/2023/10/15/r6ZFN.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">HGAME_WEEK1_WP</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/04/07/HGAME2022-partialPWN/" title="HGAME2022_partialPWN"><img class="cover" src="https://i.imgs.ovh/2023/10/15/r6672.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-07</div><div class="title">HGAME2022_partialPWN</div></div></a></div><div><a href="/2021/03/21/HGAME_FINAL/" title="HGAME-FINAL-RE"><img class="cover" src="https://i.imgs.ovh/2023/10/15/r6LG0.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-21</div><div class="title">HGAME-FINAL-RE</div></div></a></div><div><a href="/2021/03/14/HGAME_WEEK3_WP/" title="HGAME_WEEK3_WP"><img class="cover" src="https://i.imgs.ovh/2023/10/15/r62ut.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-14</div><div class="title">HGAME_WEEK3_WP</div></div></a></div><div><a href="/2021/03/14/HGAME_WEEK2_WP/" title="HGAME_WEEK2_WP"><img class="cover" src="https://i.imgs.ovh/2023/10/15/r6F8m.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-14</div><div class="title">HGAME_WEEK2_WP</div></div></a></div><div><a href="/2021/03/14/HGAME_WEEK1_WP/" title="HGAME_WEEK1_WP"><img class="cover" src="https://i.imgs.ovh/2023/10/15/r6ZFN.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-14</div><div class="title">HGAME_WEEK1_WP</div></div></a></div><div><a href="/2021/07/19/rctf_valgrind/" title="RCTF Valgrind"><img class="cover" src="https://i.imgs.ovh/2023/10/15/r6PWX.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-19</div><div class="title">RCTF Valgrind</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.imgs.ovh/2023/10/13/XDQ7p.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">RT</div><div class="author-info__description">@Vidar-Team @CTFer @Game Lover </div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">36</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">30</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/wr-web"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/wr-web" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:orz1053131305@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://wr-web.github.io/atom.xml" target="_blank" title="Rss"><i class="fas fa-rss" style="color: #2d69d7;"></i></a><a class="social-icon" href="https://space.bilibili.com/13582048" target="_blank" title="BiliBili"><i class="fab fa-bilibili" style="color: #00a1d6;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">家人们加个友链</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK4-RogerThat-WP"><span class="toc-number">1.</span> <span class="toc-text">WEEK4-RogerThat WP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Re"><span class="toc-number">1.1.</span> <span class="toc-text">Re</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#vm"><span class="toc-number">1.1.1.</span> <span class="toc-text">vm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#nllvm"><span class="toc-number">1.1.2.</span> <span class="toc-text">nllvm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#A-5-Second-Challenge"><span class="toc-number">1.1.3.</span> <span class="toc-text">A 5 Second Challenge</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/10/24/%E6%95%A3%E8%A8%98-10-24-23/" title="如何给 LLVM RISCV 添加一条“指令”（改进）"><img src="https://i.imgs.ovh/2023/10/21/2STWC.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何给 LLVM RISCV 添加一条“指令”（改进）"/></a><div class="content"><a class="title" href="/2023/10/24/%E6%95%A3%E8%A8%98-10-24-23/" title="如何给 LLVM RISCV 添加一条“指令”（改进）">如何给 LLVM RISCV 添加一条“指令”（改进）</a><time datetime="2023-10-24T04:00:00.000Z" title="发表于 2023-10-24 12:00:00">2023-10-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/21/%E6%95%A3%E8%A8%98-10-21-23/" title="如何给 LLVM RISCV 添加一条“指令”"><img src="https://i.imgs.ovh/2023/10/21/2STWC.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何给 LLVM RISCV 添加一条“指令”"/></a><div class="content"><a class="title" href="/2023/10/21/%E6%95%A3%E8%A8%98-10-21-23/" title="如何给 LLVM RISCV 添加一条“指令”">如何给 LLVM RISCV 添加一条“指令”</a><time datetime="2023-10-21T04:00:00.000Z" title="发表于 2023-10-21 12:00:00">2023-10-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/18/Dynamic%20Programming/" title="算法學習笔记"><img src="https://i.imgs.ovh/2023/10/19/2wG4J.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="算法學習笔记"/></a><div class="content"><a class="title" href="/2023/10/18/Dynamic%20Programming/" title="算法學習笔记">算法學習笔记</a><time datetime="2023-10-18T04:00:00.000Z" title="发表于 2023-10-18 12:00:00">2023-10-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/15/%E6%95%A3%E8%A8%98-10-14-23/" title="论文笔记:Tracer:Signature-based Static Analysis for Detecting Recurring Vulnerabilities"><img src="https://i.imgs.ovh/2023/10/13/XDJVK.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="论文笔记:Tracer:Signature-based Static Analysis for Detecting Recurring Vulnerabilities"/></a><div class="content"><a class="title" href="/2023/10/15/%E6%95%A3%E8%A8%98-10-14-23/" title="论文笔记:Tracer:Signature-based Static Analysis for Detecting Recurring Vulnerabilities">论文笔记:Tracer:Signature-based Static Analysis for Detecting Recurring Vulnerabilities</a><time datetime="2023-10-15T04:00:00.000Z" title="发表于 2023-10-15 12:00:00">2023-10-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/14/%E6%95%A3%E8%A8%98-10-13-23/" title="散記"><img src="https://i.imgs.ovh/2023/10/15/r3Uw2.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="散記"/></a><div class="content"><a class="title" href="/2023/10/14/%E6%95%A3%E8%A8%98-10-13-23/" title="散記">散記</a><time datetime="2023-10-14T04:00:00.000Z" title="发表于 2023-10-14 12:00:00">2023-10-14</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://i.imgs.ovh/2023/10/15/r6rpC.jpeg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By RT</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const initGitalk = () => {
    const gitalk = new Gitalk(Object.assign({
      clientID: '017d73efa3d7d9bd35c1',
      clientSecret: '0b3746330e76c8310d622e4ae2d18a227afdfdd1',
      repo: 'blog_talk',
      owner: 'wr-web',
      admin: ['wr-web'],
      id: '51872e185cc75b8c99f68f7fb00f595a',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async() => {
    if (typeof Gitalk === 'function') initGitalk()
    else {
      await getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
      await getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js')
      initGitalk()
    }
  }
  
  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  if ('Gitalk' === 'Gitalk' || !false) {
    if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>