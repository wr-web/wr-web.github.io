<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#6200ee"><meta name="author" content="RT"><meta name="copyright" content="RT"><meta name="generator" content="Hexo 6.0.0"><meta name="theme" content="hexo-theme-yun"><title>HGAME_WEEK4_WP | R0gerThat</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/gh/github/wr-web/picture/blob/main/author2.ico"><link rel="mask-icon" href="https://cdn.jsdelivr.net/gh/github/wr-web/picture/blob/main/author2.ico" color="#6200ee"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"wr-web.github.io","root":"/","title":"RT の Diary","version":"1.7.0","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="alternate" href="/atom.xml" title="R0gerThat" type="application/atom+xml"><meta name="description" content="HGAME WP">
<meta property="og:type" content="article">
<meta property="og:title" content="HGAME_WEEK4_WP">
<meta property="og:url" content="https://wr-web.github.io/2021/03/14/HGAME_WEEK4_WP/index.html">
<meta property="og:site_name" content="R0gerThat">
<meta property="og:description" content="HGAME WP">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wr-web/picture/breakpoints.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wr-web/picture/YouLoser.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wr-web/picture/unityMain.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wr-web/picture/UnityMain_2.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wr-web/picture/gameAssembly.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wr-web/picture/dump.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wr-web/picture/new.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wr-web/picture/old.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wr-web/picture/first.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wr-web/picture/firstNop.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wr-web/picture/second_change.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wr-web/picture/final_change.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wr-web/picture/YouLoser0.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wr-web/picture/QRCODE.jpg">
<meta property="article:published_time" content="2021-03-14T12:00:00.000Z">
<meta property="article:modified_time" content="2022-03-07T10:16:59.738Z">
<meta property="article:author" content="RT">
<meta property="article:tag" content="WP">
<meta property="article:tag" content="HGAME">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/wr-web/picture/breakpoints.jpg"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="RT"><img width="96" loading="lazy" src="https://cdn.jsdelivr.net/gh/wr-web/picture/author2.ico" alt="RT"></a><div class="site-author-name"><a href="/about/">RT</a></div><span class="site-name">R0gerThat</span><sub class="site-subtitle"></sub><div class="site-desciption">@Vidar-Team @CTFer @Game Lover </div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">19</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">14</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">20</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/wr-web" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/13582048" title="哔哩哔哩" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://t.me/R0gerTh4t" title="Telegram" target="_blank" style="color:#0088CC"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-telegram-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:orz1053131305@outlook.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK4-RogerThat-WP"><span class="toc-number">1.</span> <span class="toc-text">WEEK4-RogerThat WP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Re"><span class="toc-number">1.1.</span> <span class="toc-text">Re</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#vm"><span class="toc-number">1.1.1.</span> <span class="toc-text">vm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#nllvm"><span class="toc-number">1.1.2.</span> <span class="toc-text">nllvm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#A-5-Second-Challenge"><span class="toc-number">1.1.3.</span> <span class="toc-text">A 5 Second Challenge</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://wr-web.github.io/2021/03/14/HGAME_WEEK4_WP/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="RT"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="R0gerThat"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">HGAME_WEEK4_WP</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="创建时间：2021-03-14 20:00:00" itemprop="dateCreated datePublished" datetime="2021-03-14T20:00:00+08:00">2021-03-14</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="修改时间：2022-03-07 18:16:59" itemprop="dateModified" datetime="2022-03-07T18:16:59+08:00">2022-03-07</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/HGAME/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">HGAME</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/WP/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">WP</span></a><a class="tag-item" href="/tags/HGAME/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">HGAME</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#6200ee;"><h2 id="WEEK4-RogerThat-WP"><a href="#WEEK4-RogerThat-WP" class="headerlink" title="WEEK4-RogerThat WP"></a>WEEK4-RogerThat WP</h2><p>这周有点寒碜，只有三道题</p>
<h3 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h3><h4 id="vm"><a href="#vm" class="headerlink" title="vm"></a>vm</h4><p>这道题是一道虚拟机相关的题目，因此分许需要花不少时间，在没做出来之前也慢慢试着写点东西，希望也能有所收获。</p>
<p>首先寻找到main函数</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  FILE <span class="token operator">*</span>v3<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>v5<span class="token punctuation">;</span> <span class="token comment">// rcx</span>
  <span class="token keyword">char</span> Buffer<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+20h] [rbp-38h] BYREF</span>

  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Welcome to ovm++!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">j_inilization</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Input your flag: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v3 <span class="token operator">=</span> <span class="token function">_acrt_iob_func</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fgets</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> v3<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">j_printf_</span><span class="token punctuation">(</span><span class="token string">"Your flag is: %s\n"</span><span class="token punctuation">,</span> Buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"VM started successfully!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">j_vm_function</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__int64<span class="token punctuation">)</span><span class="token operator">&amp;</span>qword_7FF7ADCEE378<span class="token punctuation">,</span> <span class="token punctuation">(</span>__int64<span class="token punctuation">)</span>Buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v4 <span class="token operator">=</span> <span class="token function">memcmp</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_7FF7ADCEBD68<span class="token punctuation">,</span> <span class="token number">0x22u</span>i64<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v5 <span class="token operator">=</span> <span class="token string">"nop"</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>v4 <span class="token punctuation">)</span>
    v5 <span class="token operator">=</span> <span class="token string">"good"</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span>v5<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/breakpoints.jpg" alt="breakpoints" loading="lazy"></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">#dialog
mov 83 to 000000B1524FF781
mov 46 to 000000B1524FF780
mov 23 to 000000B1524FF77F
mov 1 to 000000B1524FF77E
mov EC to 000000B1524FF77D
#.....
mov 90 to 000000B1524FF764
mov 75 to 000000B1524FF763
mov 5A to 000000B1524FF762
mov 39 to 000000B1524FF761
mov E9 to 000000B1524FF760
#一次循环加密
mov 9 to 000000B1524FF781
mov 2C to 000000B1524FF780
mov 69 to 000000B1524FF77F
mov A7 to 000000B1524FF77E
mov F2 to 000000B1524FF77D
#...
mov 3B to 000000B1524FF763
mov 80 to 000000B1524FF762
mov BF to 000000B1524FF761
mov CF to 000000B1524FF760
#第二次加密<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>大致可以得出是加密了两遍，把某一个值计算得到后移到对应位置，这个位置从最后一位到第一位再从最后一位到第一位，两次加密，得到结果</p>
<p>再进一步看看每个位置的结果是结果什么得到的</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">#第一次循环下
rdx:A
rdx:8
rdx:C
rdx:B
rdx:D
rdx:12
rdx:14
rdx:D
rdx:2&#x2F;&#x2F;different
rdx:13
rdx:7
rdx:15
rdx:C
rdx:11&#x2F;different
rdx:9
rdx:16
#第二次循环下
rdx:A
rdx:8
rdx:C
rdx:B
rdx:D
rdx:12
rdx:14
rdx:D
rdx:6 &#x2F;&#x2F;different
rdx:13
rdx:7
rdx:15
rdx:C
rdx:4 &#x2F;&#x2F;different
rdx:9
rdx:16<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-none"><code class="language-none">A:PUSH_BX
8:PUSH
C:POP_AX
B:PUSH_DX
D:POP_BX
12:CMP
14:JZ
D:POP_BX<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>由此可见A,8,C,B,D,12,14,D,2,13,7,15,C,11,9,16;这些 OPCODE 组成了一个加密的循环，而第一个嘛我也不清楚，总之它的结果是’{‘—&gt;?应该也不用太在意</p>
<p>通过对比两次输入的rdx流，发现这个关于每个字符是独立加密的，也就是缺少“扩散”的一种加密方法，虽然这样我更好做题目了，hhha</p>
<p>整理加密的伪代码之后得到如下结果</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">struct VM&#123;
        uint64_t *alloc_mem_pt;
        uint64_t *buffer_pt;
        uint8_t a;
        uint8_t x1;
        uint8_t x2;
        uint8_t x3;
        uint8_t x4;
        uint8_t b;
&#125;vm;

&#x2F;&#x2F;A:
    vm.x3 &#x3D; v8 + 1;
    *(_BYTE *)(vm.x3 + pt_of_memory) &#x3D; vm.x1;
    goto LABEL_32;
&#x2F;&#x2F;8:
    function();
    vm.x3 &#x3D; v8 + 1;
    *(_BYTE *)(vm.x3 + pt_of_memory) &#x3D; v2;

&#x2F;&#x2F;。。。。。。。。。。。。。
&#x2F;&#x2F;。。。。。。。。。。。。。
&#x2F;&#x2F;我的愚昧的伪代码，留在这警示一下我自己 &#x2F;吐血.jpg
    result &#x3D; *a1;
    v7 &#x3D; *a1 + 8 * v18;
    if ( !*(_BYTE *)(v7 + 4) )
        continue;

void function()&#123;
    v11 &#x3D; v5++;
    vm.x4 &#x3D; v5;
    v2 &#x3D; *(_BYTE *)(*a1 + 8 * v11);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>接下来思路就简单了，要么静态分析，要么动态调试一波，总之为了理解这个程序流不择手段2333<br>其实也可以分析汇编，不过估计伪代码应该比汇编简单一些</p>
<p>大意了，看出第一个循环是从后往前异或，没想到第二个循环变了.</p>
<p>这里吐槽一下我自己吧，伪代码已经那么诡异了，我为什么还要把伪代码修改成我自己的伪代码……………………………直接看ida的伪代码看熟悉了应该就可以了吧，如果真的要写成我自己的伪代码的话，估计得涉及到很多高级的重构方法了，要是真的能那么做的话，我也可以写个IDA了hhhha，所以结论就是我应该做不到</p>
<p>看出第一个阶段是异或，第二个阶段是减去莫个值，因此我们dump下来这个值就好了</p>
<p>上脚本</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">encrypted   <span class="token operator">=</span><span class="token string">b'\xCF\xBF\x80\x3B\xF6\xAF\x7E\x02\x24\xED\x70\x3A\xF4\xEB\x7A\x4A\xE7\xF7\xA2\x67\x17\xF0\xC6\x76\x36\xE8\xAD\x82\x2E\xDB\xB7\x4F\xE6\x09'</span>
xor_key     <span class="token operator">=</span><span class="token string">b'\xFE\x21\x44\x67\x8A\xAD\xD0\xF3\x16\x39\x5C\x7F\xA2\xC5\xE8\x0B\x2E\x51\x74\x97\xBA\xDD\x00\x23\x46\x69\x8C\xAF\xD2\xF5\x18\x3B\x5E\x81'</span>
decrease_key<span class="token operator">=</span><span class="token string">b'\x7A\x1A\xBA\x5A\xFA\x9A\x3A\xDA\x7A\x1A\xBA\x5A\xFA\x9A\x3A\xDA\x7A\x1A\xBA\x5A\xFA\x9A\x3A\xDA\x7A\x1A\xBA\x5A\xFA\x9A\x3A\xDA\x7A\x1A'</span>
decrypted   <span class="token operator">=</span><span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    temp_num <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>encrypted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token builtin">int</span><span class="token punctuation">(</span>decrease_key<span class="token punctuation">[</span><span class="token number">33</span><span class="token operator">-</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    temp_num <span class="token operator">&amp;</span><span class="token operator">=</span> <span class="token number">0xFF</span>
    temp_num <span class="token operator">^</span><span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>xor_key<span class="token punctuation">[</span><span class="token number">33</span><span class="token operator">-</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    decrypted <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>temp_num<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>decrypted<span class="token punctuation">)</span>
<span class="token comment">#decrypted = “hgame&#123;w0W!itS_CpP_wItH_little_vM!&#125;”</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>看来还有好多可以琢磨的了，怪不得这道题有人做这么快。这个虚拟机的指令真的不是简单的指令，我本来以为是相当于push,pop这种，最后想一下应该是相当于一个函数了，然后又因为一些交叉的变量看起来比较复杂，这点看来很值得思考了。</p>
<p>x64日志dump挺好用的，<a target="_blank" rel="noopener" href="https://help.x64dbg.com/en/latest/introduction/Formatting.html">https://help.x64dbg.com/en/latest/introduction/Formatting.html</a></p>
<h4 id="nllvm"><a href="#nllvm" class="headerlink" title="nllvm"></a>nllvm</h4><p>虽说和 llvm 和 ollvm 有一定关系，但是这个混淆只是单纯的增长，程序流并没有混淆</p>
<p>根据程序流，或者根据加密过程中 <strong>sbox</strong> ，可以判断出是 aes ，但是是不是 aes 变种呢，由于我对aes-256 cbc 有所误解，以为key的长度不能是 64 字节，导致我只好手撸这道题，不过想来，如果这样子的话我以后就能对付变种了，虽然。。。建立在我被自己坑的基础上。</p>
<p>不过由于是数论的东西，我也要mark一下。在 GF(2^8) 域上，加法和乘法不是我们一般的域的加法，乘法则需要左移一位，然后再判断正负,乘以 0x1b 之类，正如下面的 Multiply 宏定义。而 xtime 是用于乘法，详细的见<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Jeely/p/11724506.html%EF%BC%8C%E5%85%B6%E5%AE%9E%E6%89%8B%E6%92%B8">https://www.cnblogs.com/Jeely/p/11724506.html，其实手撸</a> aes 我觉得还是挺有价值的。因为我大一下 hgame 中也做过一道，那道我是用代码辅助手算得到的 flag ，痛苦得很。。。不过感觉数论好重要啊。。。可能我是一个密码手 2333</p>
<p>如果要复现的话一种可能就是用宏函数，在没有什么优化的情况下应该是能让函数如此之长，还有一种就是使用一些混淆的工具，如 ollvm 这种，这种应该就要调试分析了。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdint.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">Multiply</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>                                </span><span class="token punctuation">\</span>
      <span class="token expression"><span class="token punctuation">(</span>  <span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> x<span class="token punctuation">)</span> <span class="token operator">^</span>                              </span><span class="token punctuation">\</span>
      <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token operator">>></span><span class="token number">1</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">xtime</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span>                       </span><span class="token punctuation">\</span>
      <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token operator">>></span><span class="token number">2</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">xtime</span><span class="token punctuation">(</span><span class="token function">xtime</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span>                </span><span class="token punctuation">\</span>
      <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token operator">>></span><span class="token number">3</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">xtime</span><span class="token punctuation">(</span><span class="token function">xtime</span><span class="token punctuation">(</span><span class="token function">xtime</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span>         </span><span class="token punctuation">\</span>
      <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token operator">>></span><span class="token number">4</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">xtime</span><span class="token punctuation">(</span><span class="token function">xtime</span><span class="token punctuation">(</span><span class="token function">xtime</span><span class="token punctuation">(</span><span class="token function">xtime</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   </span><span class="token punctuation">\</span>
</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">uint8_t</span> rsbox<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd5</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9e</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xf3</span><span class="token punctuation">,</span> <span class="token number">0xd7</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span>
        <span class="token number">0x7c</span><span class="token punctuation">,</span> <span class="token number">0xe3</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0x9b</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0x8e</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0xc4</span><span class="token punctuation">,</span> <span class="token number">0xde</span><span class="token punctuation">,</span> <span class="token number">0xe9</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span>
        <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x7b</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0x3d</span><span class="token punctuation">,</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xc3</span><span class="token punctuation">,</span> <span class="token number">0x4e</span><span class="token punctuation">,</span>
        <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x2e</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0xb2</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x5b</span><span class="token punctuation">,</span> <span class="token number">0xa2</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x6d</span><span class="token punctuation">,</span> <span class="token number">0x8b</span><span class="token punctuation">,</span> <span class="token number">0xd1</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span>
        <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xf8</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xa4</span><span class="token punctuation">,</span> <span class="token number">0x5c</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0xb6</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span>
        <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0xfd</span><span class="token punctuation">,</span> <span class="token number">0xed</span><span class="token punctuation">,</span> <span class="token number">0xb9</span><span class="token punctuation">,</span> <span class="token number">0xda</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0xa7</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span>
        <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x8c</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0xb8</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span>
        <span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x1e</span><span class="token punctuation">,</span> <span class="token number">0x8f</span><span class="token punctuation">,</span> <span class="token number">0xca</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0x0f</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0xc1</span><span class="token punctuation">,</span> <span class="token number">0xaf</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span>
        <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0xea</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0xf2</span><span class="token punctuation">,</span> <span class="token number">0xcf</span><span class="token punctuation">,</span> <span class="token number">0xce</span><span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0xb4</span><span class="token punctuation">,</span> <span class="token number">0xe6</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span>
        <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0xac</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0xe7</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0xe2</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0x1c</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0xdf</span><span class="token punctuation">,</span> <span class="token number">0x6e</span><span class="token punctuation">,</span>
        <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0xf1</span><span class="token punctuation">,</span> <span class="token number">0x1a</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0xb7</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span>
        <span class="token number">0xfc</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x3e</span><span class="token punctuation">,</span> <span class="token number">0x4b</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0xd2</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0xdb</span><span class="token punctuation">,</span> <span class="token number">0xc0</span><span class="token punctuation">,</span> <span class="token number">0xfe</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0xcd</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0xf4</span><span class="token punctuation">,</span>
        <span class="token number">0x1f</span><span class="token punctuation">,</span> <span class="token number">0xdd</span><span class="token punctuation">,</span> <span class="token number">0xa8</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0xc7</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0xb1</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xec</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span>
        <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x7f</span><span class="token punctuation">,</span> <span class="token number">0xa9</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0xb5</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span> <span class="token number">0xe5</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0xc9</span><span class="token punctuation">,</span> <span class="token number">0x9c</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span>
        <span class="token number">0xa0</span><span class="token punctuation">,</span> <span class="token number">0xe0</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0x2a</span><span class="token punctuation">,</span> <span class="token number">0xf5</span><span class="token punctuation">,</span> <span class="token number">0xb0</span><span class="token punctuation">,</span> <span class="token number">0xc8</span><span class="token punctuation">,</span> <span class="token number">0xeb</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0x3c</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span>
        <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0x2b</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x7e</span><span class="token punctuation">,</span> <span class="token number">0xba</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0xd6</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token number">0x7d</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">uint8_t</span> const_key<span class="token punctuation">[</span><span class="token number">257</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"\x43\x72\x79\x70\x74\x6F\x46\x41\x49\x4C\x55\x52\x45\x66\x6F\x72"</span>
                                 <span class="token string">"\x52\x53\x41\x32\x30\x34\x38\x4B\x65\x79\x21\x21\x21\x21\x21\x21"</span>
                                 <span class="token string">"\xBF\x8F\x84\x8D\xCB\xE0\xC2\xCC\x82\xAC\x97\x9E\xC7\xCA\xF8\xEC"</span>
                                 <span class="token string">"\x94\x27\x00\xFC\xA4\x13\x38\xB7\xC1\x6A\x19\x96\xE0\x4B\x38\xB7"</span>
                                 <span class="token string">"\x0E\x88\x2D\x6C\xC5\x68\xEF\xA0\x47\xC4\x78\x3E\x80\x0E\x80\xD2"</span>
                                 <span class="token string">"\x59\x8C\xCD\x49\xFD\x9F\xF5\xFE\x3C\xF5\xEC\x68\xDC\xBE\xD4\xDF"</span>
                                 <span class="token string">"\xA4\xC0\xB3\xEA\x61\xA8\x5C\x4A\x26\x6C\x24\x74\xA6\x62\xA4\xA6"</span>
                                 <span class="token string">"\x7D\x26\x84\x6D\x80\xB9\x71\x93\xBC\x4C\x9D\xFB\x60\xF2\x49\x24"</span>
                                 <span class="token string">"\x25\xFB\x85\x3A\x44\x53\xD9\x70\x62\x3F\xFD\x04\xC4\x5D\x59\xA2"</span>
                                 <span class="token string">"\x61\x6A\x4F\x57\xE1\xD3\x3E\xC4\x5D\x9F\xA3\x3F\x3D\x6D\xEA\x1B"</span>
                                 <span class="token string">"\x09\x7C\x2A\x1D\x4D\x2F\xF3\x6D\x2F\x10\x0E\x69\xEB\x4D\x57\xCB"</span>
                                 <span class="token string">"\x88\x89\x14\x48\x69\x5A\x2A\x8C\x34\xC5\x89\xB3\x09\xA8\x63\xA8"</span>
                                 <span class="token string">"\xEB\x87\xE8\x1C\xA6\xA8\x1B\x71\x89\xB8\x15\x18\x62\xF5\x42\xD3"</span>
                                 <span class="token string">"\x22\x6F\x38\x2E\x4B\x35\x12\xA2\x7F\xF0\x9B\x11\x76\x58\xF8\xB9"</span>
                                 <span class="token string">"\xC1\xC6\xBE\x24\x67\x6E\xA5\x55\xEE\xD6\xB0\x4D\x8C\x23\xF2\x9E"</span>
                                 <span class="token string">"\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0A\x0B\x0C\x0D\x0E\x0F"</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">uint8_t</span> const_iv<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0A\x0B\x0C\x0D\x0E\x0F"</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">uint8_t</span> const_data<span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"\x91\xB3\xC1\xEB\x14\x5D\xD5\xCE\x3A\x1D\x30\xE4\x70\x6C\x6B\xD7"</span>
                                      <span class="token string">"\x69\x78\x79\x02\xA3\xA5\xDF\x1B\xFD\x1C\x02\x89\x14\x20\x7A\xFD"</span>
                                      <span class="token string">"\x24\x52\xF8\xA9\xF9\xF1\x6B\x1C\x0F\x5D\x50\x5B\xEC\x42\xD1\x8C"</span>
                                      <span class="token string">"\xB8\x12\xCF\x2C\xA9\x69\x31\x46\xFD\x9B\xEA\xDE\xC8\xBF\x94\x69"</span><span class="token punctuation">;</span>
<span class="token comment">//                                        "\x92\x16\x48\xBB\x9F\x81\xE0\x47\x7D\xEB\x40\x70\x07\x9E\x2A\x87"</span>
<span class="token comment">//                                      "\x87\xC4\x00\xCB\x2F\xC2\x09\x4C\x9E\x4B\x72\xC6\x84\xDE\x54\x7E"</span>
<span class="token comment">//                                      "\xAB\x5A\xB8\x46\x0A\xBD\x04\x1E\xFE\x62\x0A\xCC\xFB\xA0\x99\xA5"</span>
<span class="token comment">//                                      "\xA2\x83\xF4\x83\x64\x6C\xC1\xE5\xD2\x37\x9E\xC9\x9D\xF0\x28\x6C";</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">InvMixRows</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token class-name">uint8_t</span> <span class="token function">xtime</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">xorKey</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span>state<span class="token punctuation">,</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">invColShift</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token operator">*</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">invSbox</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token operator">*</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">uint8_t</span> iv<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span>key<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">memcpy</span><span class="token punctuation">(</span>iv<span class="token punctuation">,</span>const_iv<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">memcpy</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>const_key<span class="token punctuation">,</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">memcpy</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>const_data<span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>j <span class="token operator">&lt;</span> <span class="token number">14</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token function">xorKey</span><span class="token punctuation">(</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">,</span>key<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token operator">-</span>j<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token function">InvMixRows</span><span class="token punctuation">(</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">invColShift</span><span class="token punctuation">(</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">invSbox</span><span class="token punctuation">(</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token function">xorKey</span><span class="token punctuation">(</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">-</span>i<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token function">xorKey</span><span class="token punctuation">(</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">,</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            <span class="token function">xorKey</span><span class="token punctuation">(</span>data<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">,</span>iv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">(</span>data<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token comment">//    uint8_t test[4][4] = &#123;0&#125;;</span>
<span class="token comment">//    test[0][0] = 0xF1^0x72^0xEB^xtime(0x77^0xF1);</span>
<span class="token comment">//    test[0][1] = 0x77^0x72^0xEB^xtime(0xF1^0x72);</span>
<span class="token comment">//    test[0][2] = 0x77^0xF1^0xEB^xtime(0x72^0xEB);</span>
<span class="token comment">//    test[0][3] = 0x77^0xF1^0x72^xtime(0xEB^0x77);</span>
<span class="token comment">//    InvMixRows((uint8_t*)test);</span>


    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">xorKey</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span>state<span class="token punctuation">,</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span>i<span class="token punctuation">)</span> <span class="token operator">^=</span> <span class="token operator">*</span><span class="token punctuation">(</span>key<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">invColShift</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token operator">*</span>state<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token class-name">uint8_t</span> a   <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">uint8_t</span> b1  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">uint8_t</span> b2  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">uint8_t</span> c   <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">9</span><span class="token punctuation">)</span>  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token operator">=</span> a<span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">=</span> b1<span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">)</span>  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">14</span><span class="token punctuation">)</span> <span class="token operator">=</span> b2<span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">7</span><span class="token punctuation">)</span>  <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">invSbox</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token operator">*</span> state<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> rsbox<span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">(</span>state<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">InvMixRows</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span>state<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token class-name">int8_t</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        a <span class="token operator">=</span> <span class="token punctuation">(</span>__int8<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        b <span class="token operator">=</span> <span class="token punctuation">(</span>__int8<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        c <span class="token operator">=</span> <span class="token punctuation">(</span>__int8<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        d <span class="token operator">=</span> <span class="token punctuation">(</span>__int8<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">)</span>     <span class="token operator">=</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>state <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">Multiply</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">static</span> <span class="token class-name">uint8_t</span> <span class="token function">xtime</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> x<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">>></span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0x1b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//hgame&#123;cOsm0s_is_still_fight1ng_and_NEVER_GIVE_UP_O0o0o0oO00o00o&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="A-5-Second-Challenge"><a href="#A-5-Second-Challenge" class="headerlink" title="A 5 Second Challenge"></a>A 5 Second Challenge</h4><p>il2cpp逆向题目，没想到我技能树点歪了</p>
<p>先上图：<br>听说你叫扫雷的.jpg<br><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/YouLoser.png" alt="YouLoser" loading="lazy"></p>
<p>其实我玩扫雷很菜，但是炸弹炸不死我 2333<br>为了破解这个东西，我干了好多活，最累的其实是点开 💣，再其次是画二维码。</p>
<p>那我现在从头开始讲。</p>
<p>由于开始时对unity的一些文件配置完全不懂，导致我看的晕头转向。不过看了别人逆向的一些实例，我大概理解了文件结构。那我写长一点，从启动函数开始。</p>
<p>众所周知为了玩游戏，点开了游戏，但是游戏 .exe 里面其实并没有游戏的逻辑<br><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/unityMain.jpg" alt="unityMain" loading="lazy"></p>
<p>直接跳转到了 UnityMain 函数中，而这个函数在别的 dll 中，我们可以打开 PE-bear 其实也可以自己对着节区去看，不过算起来比较复杂，有现成的工具用一下也挺好</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/UnityMain_2.jpg" alt="UnityMain_2" loading="lazy"></p>
<p>然后我们就开始对 UnityPlayer 释放魔法（动态调试），发现 UnityPlayer 其实是通过 CreatWindowExW 创建句柄，传递给 showWindow，最终打开 unity 窗口。其中 sub0x180547E70 可以称为 Load_Game_function （我自己这么定义的 233 ）</p>
<p>其中 sub_180088310 函数常用于检测或者加载是否加载成功一些文件，比如 app.info , config , Play.log 等文件，但是我们仍然找不到游戏逻辑，继续追踪发现在</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/gameAssembly.jpg" alt="gameAssembly" loading="lazy"></p>
<p>此处加载了 GameAssembly.dll 加载成功后会 继续加载一些文件比如 $(game)&#x2F;game_data&#x2F;il2cpp_data&#x2F;etc , 再后来也会加载一些 creen 相关的模块 ，不顾哦这个我也不懂 ，过了一段函数，会加载一堆 dll ，最后就是打开窗口 showWindow . 再进一步就可以调试 GameAssembly.dll 结合网上所说，GameAssembly.dll 中包含着游戏的逻辑，我对他就更加期待了起来。</p>
<p>打开会发现很多名为 il2cpp_XXX_XXX_XXX 的函数，查阅一些别人的博客，再加自己的动态调试，加看 IL 源码 ，我也稍微理解了一些il2cpp_xxx 函数的作用 ，因为是从 C# -&gt; CPP -&gt; PE 他面向对象的方法，思想也就变成了 il2cpp_xxx 的一些函数，而在 il2cpp 源码中比如这一段</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// System.Boolean AFiveSecondChallenge.BombChecker::CheckIfExpired()</span>
IL2CPP_EXTERN_C IL2CPP_METHOD_ATTR <span class="token keyword">bool</span> <span class="token function">BombChecker_CheckIfExpired_m11965D79AB8C709FB9F999ACFFA108438A43652E</span> <span class="token punctuation">(</span><span class="token keyword">const</span> RuntimeMethod<span class="token operator">*</span> method<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">static</span> <span class="token keyword">bool</span> s_Il2CppMethodInitialized<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>s_Il2CppMethodInitialized<span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">il2cpp_codegen_initialize_method</span> <span class="token punctuation">(</span>BombChecker_CheckIfExpired_m11965D79AB8C709FB9F999ACFFA108438A43652E_MetadataUsageId<span class="token punctuation">)</span><span class="token punctuation">;</span>
		s_Il2CppMethodInitialized <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">IL2CPP_RUNTIME_CLASS_INIT</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int64_t</span> L_0 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_StaticFields<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_static_fields_for</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">get_firstQueryTime_4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>L_0<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">goto</span> IL_001b<span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">IL2CPP_RUNTIME_CLASS_INIT</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int64_t</span> L_1 <span class="token operator">=</span> <span class="token function">BombChecker_GetNowUnixTime_m02658B00EEC2CD986B3894FB392B39BB186716A8</span><span class="token punctuation">(</span><span class="token comment">/*hidden argument*/</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int64_t</span> L_2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_StaticFields<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_static_fields_for</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">get_firstQueryTime_4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int32_t</span> L_3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_StaticFields<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_static_fields_for</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">get_expireIn_5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">bool</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int64_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int64_t</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_subtract</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int64_t</span><span class="token punctuation">)</span>L_1<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int64_t</span><span class="token punctuation">)</span>L_2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int64_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int64_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int64_t</span><span class="token punctuation">)</span>L_3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
    
IL_001b<span class="token operator">:</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">bool</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>每次调用一些函数之前一般会使用 il2cpp_runtime_class_init （猜测是创建对象），然后使用 il2cpp_substract_xxx 等函数实现对对象的操作，非常奇妙的感觉，由此可以看出 <strong>只要我们在 il2cpp_runtime_class_init 下断点，我们就能知道 CheckIfExpired，通过交叉引用能找到</strong>。</p>
<p>上面所说不失为一种方法，但是事实是，即使是调试到 只有点击地雷才会 碰到断点的时候，通过条件断点，日志，我们能发现 调用了 15次 il2cpp_runtime_class_init 而从一开始运行的话调用了将近 50 次 所以通过这个方法 我们往往会偏离目标，而且找到函数之后 我们还要根据函数的逻辑去比对 il2cpp 源码 实在是离谱。由此 我们引入老大哥。 <em><strong>global-metadata.dat</strong></em></p>
<p>这个文件记载了一些被调用的字符串，还有函数名以及 偏移，这个文件有一个结构体，其实可以mark一下</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">struct</span> <span class="token class-name">Il2CppGlobalMetadataHeader</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name">int32_t</span> sanity<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> version<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> stringLiteralOffset<span class="token punctuation">;</span> <span class="token comment">// string data for managed code</span>
    <span class="token class-name">int32_t</span> stringLiteralCount<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> stringLiteralDataOffset<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> stringLiteralDataCount<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> stringOffset<span class="token punctuation">;</span> <span class="token comment">// string data for metadata</span>
    <span class="token class-name">int32_t</span> stringCount<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> eventsOffset<span class="token punctuation">;</span> <span class="token comment">// Il2CppEventDefinition</span>
    <span class="token class-name">int32_t</span> eventsCount<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> propertiesOffset<span class="token punctuation">;</span> <span class="token comment">// Il2CppPropertyDefinition</span>
    <span class="token class-name">int32_t</span> propertiesCount<span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> methodsOffset<span class="token punctuation">;</span> <span class="token comment">// Il2CppMethodDefinition</span>
    <span class="token class-name">int32_t</span> methodsCount<span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>然后通过调试得知，估计这个 Metadata 文件是在 UnityPlayer.dll 中载入的，反之我们也能从中读取到一些东西，甚至网上已经有了可以 dump Metadata 的工具 Il2cppDumper<br>hint 2: il2cpp 中间文件（源码）已经直接给了，就不太需要用 il2cppdumper 这类工具去死怼 GameAssembly.dll 了 囧</p>
<p>其实我不知道魔法少女为什么会给这个hint，估计是担心我们白怼 GameAssembly.dll ，其实正常的思路应该是去解密那个地雷矩阵，不过我一脑子扎进去就没停下来，最后造成这个结局 233。（其实 IL2CPP 读起来有点反人类，括号太多了，看着就烦…）其实这里有一个小 Tip 待会儿再讲</p>
<p>通过 Il2cppDumper 我们可以得到源码的 dll , 不过并没有具体的内容，大多只是有 偏移地址之类的 ，不过这样也足够了</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/dump.jpg" alt="dump" loading="lazy"></p>
<p>再通过 dnspy 打开 这个dll</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/new.jpg" alt="new" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/old.jpg" alt="old" loading="lazy"></p>
<p>两个对比很明显 我们得到了函数地址 ，最后就开始了魔改环节 。</p>
<p>这个环节试错比较多，我也慢慢讲</p>
<p>在 CS_Mouse_Brick 函数中我们会发现 是否发现炸弹的两条分路</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/first.jpg" alt="first" loading="lazy"></p>
<p>而在此之前我们会先检测一遍时间，我当场就把他的对我不好的逻辑 给 nop 掉了</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/firstNop.jpg" alt="firstNop" loading="lazy"></p>
<p>只改了这一处 会发现 时间过了之后，不管点什么 他都是炸弹！ 动调了一下 发现了原因</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/second_change.jpg" alt="second_change" loading="lazy"></p>
<p>这一段在 CheckBombAt 函数中 ，检测到超时之后，这里本来会指向别的地方，最终造成 点啥都是炸弹，我就把这里两个逻辑都汇聚在一起，这样这俩就都是魔法少女了。</p>
<p>最后我们还需修改一处，就是当程序发现你点了雷，他就会终止你接下来的行为。</p>
<p>而这个逻辑是在<br><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/final_change.jpg" alt="final_change" loading="lazy"></p>
<p>如果要退出他会置 1 那我反过来不让他退出，所以我就置 0；最后就成功地劫持了程序流</p>
<p>话说我刚才说了 （劫持） 。。。我这明明是 （抢劫）</p>
<p>pwn里面改不了程序流，大多通过溢出来劫持，因此称我这个为 （抢劫） 一点不过分。</p>
<p>然后就是手酸的点地雷了 233 ，再是手酸的绘制 二维码了</p>
<p>最后结果</p>
<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/YouLoser0.png" alt="YouLoser" loading="lazy"></p>
<p>其实只要缩小一下就能扫出来，还好二维码可以有误差，不然我只好裂开。</p>
<p>手~~~好酸啊，我下次一定去看矩阵。。。</p>
<p>好了，最后我再收回我说的 Tip 我们看回 il2cpp 的源码</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">&#123;</span>
	<span class="token function">IL2CPP_RUNTIME_CLASS_INIT</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">;</span>
	DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span> L_3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_StaticFields<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_static_fields_for</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">get_matrix_6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Vector2_tA85D2DD88578276CA8A8796756458277E72D073D  L_4 <span class="token operator">=</span> ___vec0<span class="token punctuation">;</span>
	<span class="token keyword">float</span> L_5 <span class="token operator">=</span> L_4<span class="token punctuation">.</span><span class="token function">get_y_1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Vector2_tA85D2DD88578276CA8A8796756458277E72D073D  L_6 <span class="token operator">=</span> ___vec0<span class="token punctuation">;</span>
	<span class="token keyword">float</span> L_7 <span class="token operator">=</span> L_6<span class="token punctuation">.</span><span class="token function">get_x_0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">NullCheck</span><span class="token punctuation">(</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span>L_3<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_8 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span>L_3<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">GetAt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span>L_5<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span>L_7<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span> L_9 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_StaticFields<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_static_fields_for</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">get_matrix_6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Vector2_tA85D2DD88578276CA8A8796756458277E72D073D  L_10 <span class="token operator">=</span> ___vec0<span class="token punctuation">;</span>
	<span class="token keyword">float</span> L_11 <span class="token operator">=</span> L_10<span class="token punctuation">.</span><span class="token function">get_y_1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Vector2_tA85D2DD88578276CA8A8796756458277E72D073D  L_12 <span class="token operator">=</span> ___vec0<span class="token punctuation">;</span>
	<span class="token keyword">float</span> L_13 <span class="token operator">=</span> L_12<span class="token punctuation">.</span><span class="token function">get_x_0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">NullCheck</span><span class="token punctuation">(</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span>L_9<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_14 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span>L_9<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">GetAt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span>L_11<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span>L_13<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	V_0 <span class="token operator">=</span> L_14<span class="token punctuation">;</span>
	DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span> L_15 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_StaticFields<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_static_fields_for</span><span class="token punctuation">(</span>BombChecker_t6F78547653A30303197DE752136BFF107B035342_il2cpp_TypeInfo_var<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">get_matrix_6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Vector2_tA85D2DD88578276CA8A8796756458277E72D073D  L_16 <span class="token operator">=</span> ___vec0<span class="token punctuation">;</span>
	<span class="token keyword">float</span> L_17 <span class="token operator">=</span> L_16<span class="token punctuation">.</span><span class="token function">get_y_1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Vector2_tA85D2DD88578276CA8A8796756458277E72D073D  L_18 <span class="token operator">=</span> ___vec0<span class="token punctuation">;</span>
	<span class="token keyword">float</span> L_19 <span class="token operator">=</span> L_18<span class="token punctuation">.</span><span class="token function">get_x_0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">NullCheck</span><span class="token punctuation">(</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span>L_15<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_20 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DoubleU5BU2CU2CU5D_t52D90E91F26D35646AF02F1D1DF3770A40CD9B7D<span class="token operator">*</span><span class="token punctuation">)</span>L_15<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">GetAt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span>L_17<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span>L_19<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span><span class="token punctuation">)</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	V_1 <span class="token operator">=</span> L_20<span class="token punctuation">;</span>
	Vector2_tA85D2DD88578276CA8A8796756458277E72D073D  L_21 <span class="token operator">=</span> ___vec0<span class="token punctuation">;</span>
	<span class="token keyword">float</span> L_22 <span class="token operator">=</span> L_21<span class="token punctuation">.</span><span class="token function">get_x_0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	V_2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_subtract</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">fmodf</span><span class="token punctuation">(</span>L_22<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3.0f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1.0f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_23 <span class="token operator">=</span> V_2<span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_24 <span class="token operator">=</span> V_2<span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_25 <span class="token operator">=</span> V_0<span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_26 <span class="token operator">=</span> V_2<span class="token punctuation">;</span>
	<span class="token keyword">double</span> L_27 <span class="token operator">=</span> V_1<span class="token punctuation">;</span>
       <span class="token comment">//此注释没什么用，请忽略</span>
	<span class="token comment">//		L_8*L_23*L_24+L_25*L_26+L_27</span>
	<span class="token comment">// L_8  = GetAt(y1,x0/3,0)</span>
	<span class="token comment">// L_23 = x0 fmodf 3 -1</span>
	<span class="token comment">// L_24 = x0 fmodf 3 -1</span>
	<span class="token comment">// L_25 = GetAt(y1,x0/3,1)</span>
	<span class="token comment">// L_26 = x0 fmodf 3 -1</span>
	<span class="token comment">// L_27 = GetAt(y1,x0/3,1)</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">bool</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_multiply</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_multiply</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>L_8<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>L_23<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>L_24<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token function">il2cpp_codegen_multiply</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>L_25<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>L_26<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>L_27<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>我们可以很快发现这个是判断是否是地雷的源码，但是很明显，这也太难看懂了，因此我建议，以后反调试，只要把 cpp -&gt; c# -&gt; il -&gt; cpp 就好了，保证大部分人看裂开，但是我们其实这里有另外一种思维，源码看不懂，那看逆向 出来的 伪代码 呗。</p>
<p>ida 中可以有</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">return</span> v9 <span class="token operator">*</span> v11 <span class="token operator">*</span> v11 <span class="token operator">+</span> v11 <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v2 <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">*</span> v10 <span class="token operator">+</span> <span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v2 <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">*</span> v10 <span class="token operator">+</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0.0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>我们再结合起来看其实就方便了很多。</p>
<p>经过测试分析，最后写出脚本<br>其中 data.py 存储着从 AFiveSecondChallenge.dll 中的一个数组结构 matrix[45][15][3]</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> data

x_matrix <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
y_matrix <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
matrix <span class="token operator">=</span> data<span class="token punctuation">.</span>matrix
<span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> matrix<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token operator">//</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>x<span class="token operator">%</span><span class="token number">3</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> matrix<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token operator">//</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>x<span class="token operator">%</span><span class="token number">3</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> matrix<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token operator">//</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
            x_matrix<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
            y_matrix<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x_matrix<span class="token punctuation">,</span>y_matrix<span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span>marker <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><img src="https://cdn.jsdelivr.net/gh/wr-web/picture/QRCODE.jpg" alt="QRCODE" loading="lazy"></p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/wr-web/picture/zhifubao_reward.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/wr-web/picture/zhifubao_reward.png" alt="支付宝" title="支付宝"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/wr-web/picture/wechat_reward.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/wr-web/picture/wechat_reward.png" alt="微信支付" title="微信支付"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>RT</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://wr-web.github.io/2021/03/14/HGAME_WEEK4_WP/" title="HGAME_WEEK4_WP">https://wr-web.github.io/2021/03/14/HGAME_WEEK4_WP/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/03/14/HGAME_WEEK3_WP/" rel="prev" title="HGAME_WEEK3_WP"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">HGAME_WEEK3_WP</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/03/14/HGAME_WEEK2_WP/" rel="next" title="HGAME_WEEK2_WP"><span class="post-nav-text">HGAME_WEEK2_WP</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>要不要和我说些什么？</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> RT</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v6.0.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.7.0</span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#6200ee" stroke-width="2" stroke-linecap="round"></circle></svg></a></div></body></html>