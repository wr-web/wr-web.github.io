<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>R0gerThat</title><meta name="author" content="RT"><meta name="copyright" content="RT"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="@Vidar-Team @CTFer @Game Lover">
<meta property="og:type" content="website">
<meta property="og:title" content="R0gerThat">
<meta property="og:url" content="https://wr-web.github.io/page/3/index.html">
<meta property="og:site_name" content="R0gerThat">
<meta property="og:description" content="@Vidar-Team @CTFer @Game Lover">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.imgs.ovh/2023/10/13/XDQ7p.jpeg">
<meta property="article:author" content="RT">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.imgs.ovh/2023/10/13/XDQ7p.jpeg"><link rel="shortcut icon" href="https://i.imgs.ovh/2023/10/13/XDJVK.jpeg"><link rel="canonical" href="https://wr-web.github.io/page/3/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":300},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'R0gerThat',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-11-20 18:39:49'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="R0gerThat" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.imgs.ovh/2023/10/13/XDQ7p.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">36</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">32</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://i.imgs.ovh/2023/10/13/XDSgm.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="R0gerThat"><span class="site-name">R0gerThat</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">R0gerThat</h1><div id="site_social_icons"><a class="social-icon" href="https://github.com/wr-web" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:orz1053131305@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://wr-web.github.io/atom.xml" target="_blank" title="Rss"><i class="fas fa-rss" style="color: #2d69d7;"></i></a><a class="social-icon" href="https://space.bilibili.com/13582048" target="_blank" title="BiliBili"><i class="fab fa-bilibili" style="color: #00a1d6;"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2022/03/13/d3d12-6/" title="DX12 第六章习题"><img class="post-bg" src="https://i.imgs.ovh/2023/10/15/rmvU5.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DX12 第六章习题"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/03/13/d3d12-6/" title="DX12 第六章习题">DX12 第六章习题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-03-13T12:00:00.000Z" title="发表于 2022-03-13 20:00:00">2022-03-13</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/DX12/">DX12</a></span></div><div class="content">DX12-6th6th Capture6.13.7Q: Merge the vertices of a box and pyramid (Exercise 4) into one large vertex buffer. Also merge the indices of the box and pyramid into one large index buffer (but do not update the index values). Then draw the box and pyramid one-by-one using the parameters of ID3D12CommandList::DrawIndexedInstanced. Use the world transformation matrix so that the box and pyramid are disjoint in world space

只要配置两个 submesh 以及在 drawIndexInstanced 的时候注意，遗憾的是我在分开两个的时候我是直接把他们坐标该改一下的。不大好
vi ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2021/12/27/sctf_2021_ret2text/" title="SCTF 2021 ret2text"><img class="post-bg" src="https://i.imgs.ovh/2023/10/15/rmasA.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SCTF 2021 ret2text"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/12/27/sctf_2021_ret2text/" title="SCTF 2021 ret2text">SCTF 2021 ret2text</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-12-27T12:00:00.000Z" title="发表于 2021-12-27 20:00:00">2021-12-27</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C/">符号执行</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C/Angr/">Angr</a></span></div><div class="content">CheckIn_ret2text符号执行部分受限于对 angr 的理解以及不是很清楚一些高级接口，只能手糊一个 hook + state 携带输入字符串符号执行过程
因为代码写的比较杂凑为理解以下代码需要知道 state.memory 中 0x0 第一个字节存着多少次输入。0x100偏移之后每个0x100存储一个结构 { type:1bytes ，size:1bytes , str:size } 只能说是对症下药了。为了找到栈溢出，需要存储上一次输入字符串可以的长度，我保存在 input_str_off&#x3D; 0x100000 。我的命名多少有点古怪，明明是个 size ，我把它命名成了 str_off …
要是有什么更好的写法，一定要告诉我呀~
2022&#x2F;3&#x2F;7 补充 hook 的写法可以写的简洁一些。这道题可以直接执行，不需要自己去控制程序流或者分析。找到非约束的状态直接求解输入即可。
import claripy
import angr
from angr import SimProcedure
import IPython
import archinf ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2021/08/16/angr_learn_introduction/" title="Angr 学习与实践"><img class="post-bg" src="https://i.imgs.ovh/2023/10/15/r6CPs.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Angr 学习与实践"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/08/16/angr_learn_introduction/" title="Angr 学习与实践">Angr 学习与实践</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-08-16T12:00:00.000Z" title="发表于 2021-08-16 20:00:00">2021-08-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C/">符号执行</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C/Angr/">Angr</a></span></div><div class="content">Angrexamplelittle_engine | DONE
Script author: Michael Reeves (github: @mastermjr)Script runtime: 3 min 26 seconds (206 seconds)Concepts presented:stdin constraining, concrete optimization with Unicorn


映入眼帘的看上去应该是 CPP 编译的程序。似乎是因为一些优化或者语言本身的问题，简单的一个程序流，看上去极其诡异。动调后得知。程序会吞掉第一个输入的字符(字符的ascii要小于 0x7E)。然后剩下的是输入 flag ，flag 的长度是 75，不同函数之间通过 RDI 传递传出字符串等参数。在分析的时候会发现程序会把输入的字符串转储到 RDI 所指向的一个数据结构中。根据不同的长度进行不同的转储（我打赌源程序猿不可能写出这种东西）
然后经过一个简单的加密，不清楚什么算法，这部分通过 angr 当一个黑盒不管了。

最后通过在死亡的路径中，寻找输出流中存在 “Chugga” 的，就能 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2021/07/19/rctf_valgrind/" title="RCTF Valgrind"><img class="post-bg" src="https://i.imgs.ovh/2023/10/15/r6PWX.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RCTF Valgrind"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/07/19/rctf_valgrind/" title="RCTF Valgrind">RCTF Valgrind</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-07-19T12:00:00.000Z" title="发表于 2021-07-19 20:00:00">2021-07-19</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C/">符号执行</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C/Angr/">Angr</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C/Angr/RCTF/">RCTF</a></span></div><div class="content">Valgrind给的是 angr.SimState 对象在执行过程中输出的日志。由于网上资料也比较多，或许有些杂乱，我也做一些介绍。让大家也能快速上手。暂时就探索到这，有空再看看源码，再深入一些。

Angr : A powerful and user-friendly binary analysis platform!

一些介绍配置 angr 环境 https://docs.angr.io/introductory-errata/install
## 对于我的 wsl2 
git clone https://github.com/angr/angr-dev
cd angr-dev
./setup.sh -i -e angr
## 要是有包下不来，挂个代理，或者手动下，都可以
## 接下来要配置 ~/.bashrc
export WORK_HOME = ~/.vituralenvs
source $(find / -name "virtualenvwrapper.sh")
## 这个也可以手动设置路径
## 发现 angr venv 中导入不了 angr
## 可以在 angr ve ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2021/05/22/dll_injection_hook/" title="Dll INJECTION &amp;&amp; HOOK"><img class="post-bg" src="https://i.imgs.ovh/2023/10/15/r63Gd.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Dll INJECTION &amp;&amp; HOOK"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/05/22/dll_injection_hook/" title="Dll INJECTION &amp;&amp; HOOK">Dll INJECTION &amp;&amp; HOOK</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-05-22T12:00:00.000Z" title="发表于 2021-05-22 20:00:00">2021-05-22</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Windows/">Windows</a></span></div><div class="content">DLL INJECTION &amp;&amp; HOOK
《关于我一本书看到一半却咕了一个学期这件事》

粗略的看了一下，dll injection 和 hook 发现这俩应该是得放一起的，因为涉及的知识比较难做分隔，或者说基础知识很是接近，越是了解，就会发现越要了解 windows 的 loader 机制，windows 的一些较为有用的 api ，甚至是 windows 的内核数据结构，直接深入 windows 的 r0 还是比较猛的。
也因此这篇文章注定是随着我的学习不断更新的。
1.使用拓展最后一个节区进行注入已经写好的的DLL
这个在运行被注入的 notepad 的过程中，DLL 中的 Msg 并不会运行，只是通过 dllenterpoint 函数执行了 dllmain ，后者调用了 msgbox，弹出一个msgbox 窗体。

text 中的 0x7800 -&gt; 0x7748 也就是肯定没有 7800 那么多数据，因此后面的可以写入的就是 0x7800-0x7748。不过不够我要的 IIT 就是了。分析给的 notepad 可以知道 ，为了不影响程序的正常运行，我们 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2021/04/15/call_convention/" title="CALL_CONVENTION"><img class="post-bg" src="https://i.imgs.ovh/2023/10/15/r6VeU.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CALL_CONVENTION"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/15/call_convention/" title="CALL_CONVENTION">CALL_CONVENTION</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-04-15T12:00:00.000Z" title="发表于 2021-04-15 20:00:00">2021-04-15</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/call-convention/">call convention</a></span></div><div class="content">CALL_CONVENTIONMSVC为了让两个不同调用约定的能够互相调用，由于不同调用约定对于符号的不同修饰，我选择使用 dll 手动修改导入符号，防止符号错乱的问题。
这篇文章介绍了 MSVC 下各种调用约定。同一种调用约定在不同指令集架构下也是有区别的。https://docs.microsoft.com/en-us/cpp/build/reference/gd-gr-gv-gz-calling-convention?view=msvc-160其中有一个 vectorcall 似乎是为了优化而使用的。
0x01//CdeclCall.c
#include &lt;stdio.h>

//__declspec(dllexport) 
void  __cdecl foo(int a,int b)&#123;
    printf("a = %d , b = %d ",a,b);
&#125;



//FastCall.c
__declspec(dllimport) void __fastcall foo(int,int);

int main()&#123;
    foo(1,2 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2021/03/21/HGAME_FINAL/" title="HGAME-FINAL-RE"><img class="post-bg" src="https://i.imgs.ovh/2023/10/15/r6LG0.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HGAME-FINAL-RE"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/03/21/HGAME_FINAL/" title="HGAME-FINAL-RE">HGAME-FINAL-RE</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-03-21T12:00:00.000Z" title="发表于 2021-03-21 20:00:00">2021-03-21</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/HGAME/">HGAME</a></span></div><div class="content">hgame_final by RogerThat 对于这道题目有好两个思路可以进行，其一是直接进入程序，在逆向过程中会遇到一个接管几乎全部程序的 switch 结构。很典型的直冲直撞逆向手（在没有 hint 的情况下）。
在我这边的环境下这个函数在 sub_7FF6A2994F44

可以看出，这个代码很难看懂，但是可以看出他的分支有 46 种，一般出现这么长的 switch 结构是很有问题的，而且根据我的分析，调用不同的 switch 他会调用函数等等，输出出
Welcome to HGAME final!

what is your flag?



在一开始不知道这个和 lua 的情况下焦头烂额，因为想分析这个虚拟机难度非常高，后来我也只是在源码的帮助下才勉强理解。一开始通过 x64_dbg 自带的条件断点，我让他输出出了 siwtch 的分支。

具体的 OPCODE 我就不展示了，很长很长，而且大部分都是 case 1。
但是当我知道了它和 lua 有关，那就不一样了，内置的虚拟机必然会去执行 lua 代码，或者 lua 2 luac.out 的字节码。这个代码其实就是在 p ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2021/03/14/HGAME_WEEK3_WP/" title="HGAME_WEEK3_WP"><img class="post-bg" src="https://i.imgs.ovh/2023/10/15/r62ut.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HGAME_WEEK3_WP"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/03/14/HGAME_WEEK3_WP/" title="HGAME_WEEK3_WP">HGAME_WEEK3_WP</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-03-14T12:00:00.000Z" title="发表于 2021-03-14 20:00:00">2021-03-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/HGAME/">HGAME</a></span></div><div class="content">WEEK3-RogerThat WP萎了萎了，没时间做pwn了(游戏玩多了)
ReFAKE乱打一通，拿了一个假flag,没注意到init函数对调试器操作了一波。

这里应该是检测了是否有debugger，通过文件系统来达成，在windows中估计就是IsDebugger了，也可能有别的骚操作，暂且没见着，大胆猜测可以有多进程通信检测什么的。

针对这个比较简单的加密函数有脚本
#include &lt;idc.idc>

static main()&#123;
    auto addr = 0x401216;
    auto i = 0;
    for(i = 0;i&lt;0x43E;i++)&#123;
        PatchByte(addr+i,Byte(addr+i)^Byte(0x409080+i));
    &#125;
&#125;



解密后得到真正的比较函数
__int64 __fastcall sub_401216(__int64 a1)
&#123;
  int v2[36]; // [rsp+8h] [rbp-1D0h]
  int v3[36] ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2021/03/14/HGAME_WEEK2_WP/" title="HGAME_WEEK2_WP"><img class="post-bg" src="https://i.imgs.ovh/2023/10/15/r6F8m.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HGAME_WEEK2_WP"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/03/14/HGAME_WEEK2_WP/" title="HGAME_WEEK2_WP">HGAME_WEEK2_WP</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-03-14T12:00:00.000Z" title="发表于 2021-03-14 20:00:00">2021-03-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/HGAME/">HGAME</a></span></div><div class="content">WEEK2-WriteUpReezapk为了做这个题目我找了好多好多工具ToT

最后免费的我推荐jadx 或者jeb demo。不过jadx有些地方还是反编译不出来，很难看懂，似乎是和类型有关的部分。最后一个能打的都没有，最后跑去找到了 jeb pro用。相当的给力，虽然这道题理论上可以看字节码，也有教程讲java的字节码，但是——正经人谁看字节码呀！
在付费面前，一个能打的都没有&#x2F;doge(
在逆的过程中找到“Again?”字符串，定位到button的方法上

经过一番调教，找到MainActivity.s是一个加密函数，继续挖掘。找到

用的AES-CBC，key是SHA-256(“A_HIDEN_KEY”)，IV是MD5(“A_HIDEN_KEY”)，上脚本咯
from __future__ import absolute_import, division, unicode_literals
from Crypto.Cipher import AES
import hashlib
from binascii import unhexlify
import base64 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2021/03/14/HGAME_WEEK4_WP/" title="HGAME_WEEK4_WP"><img class="post-bg" src="https://i.imgs.ovh/2023/10/15/r6rpC.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HGAME_WEEK4_WP"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/03/14/HGAME_WEEK4_WP/" title="HGAME_WEEK4_WP">HGAME_WEEK4_WP</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-03-14T12:00:00.000Z" title="发表于 2021-03-14 20:00:00">2021-03-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/HGAME/">HGAME</a></span></div><div class="content">WEEK4-RogerThat WP这周有点寒碜，只有三道题
Revm这道题是一道虚拟机相关的题目，因此分许需要花不少时间，在没做出来之前也慢慢试着写点东西，希望也能有所收获。
首先寻找到main函数
int __cdecl main(int argc, const char **argv, const char **envp)
&#123;
  FILE *v3; // rax
  int v4; // eax
  const char *v5; // rcx
  char Buffer[40]; // [rsp+20h] [rbp-38h] BYREF

  puts("Welcome to ovm++!");
  j_inilization();
  puts("Input your flag: ");
  v3 = _acrt_iob_func(0);
  fgets(Buffer, 35, v3);
  j_printf_("Your flag is: %s\n", Buffer);
  puts("VM started successfully!");
  j_vm_fun ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/#content-inner">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/#content-inner">4</a><a class="extend next" rel="next" href="/page/4/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.imgs.ovh/2023/10/13/XDQ7p.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">RT</div><div class="author-info__description">@Vidar-Team @CTFer @Game Lover </div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">36</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">32</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/wr-web"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/wr-web" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:orz1053131305@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://wr-web.github.io/atom.xml" target="_blank" title="Rss"><i class="fas fa-rss" style="color: #2d69d7;"></i></a><a class="social-icon" href="https://space.bilibili.com/13582048" target="_blank" title="BiliBili"><i class="fab fa-bilibili" style="color: #00a1d6;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">家人们加个友链</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/11/20/%E8%8B%B1%E8%AF%AD%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="英语学习笔记"><img src="https://i.imgs.ovh/2023/11/20/HOXF2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="英语学习笔记"/></a><div class="content"><a class="title" href="/2023/11/20/%E8%8B%B1%E8%AF%AD%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="英语学习笔记">英语学习笔记</a><time datetime="2023-11-20T04:00:00.000Z" title="发表于 2023-11-20 12:00:00">2023-11-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/24/%E6%95%A3%E8%A8%98-10-24-23/" title="如何给 LLVM RISCV 添加一条“指令”（改进）"><img src="https://i.imgs.ovh/2023/10/21/2STWC.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何给 LLVM RISCV 添加一条“指令”（改进）"/></a><div class="content"><a class="title" href="/2023/10/24/%E6%95%A3%E8%A8%98-10-24-23/" title="如何给 LLVM RISCV 添加一条“指令”（改进）">如何给 LLVM RISCV 添加一条“指令”（改进）</a><time datetime="2023-10-24T04:00:00.000Z" title="发表于 2023-10-24 12:00:00">2023-10-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/18/Dynamic%20Programming/" title="算法學習笔记"><img src="https://i.imgs.ovh/2023/10/19/2wG4J.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="算法學習笔记"/></a><div class="content"><a class="title" href="/2023/10/18/Dynamic%20Programming/" title="算法學習笔记">算法學習笔记</a><time datetime="2023-10-18T04:00:00.000Z" title="发表于 2023-10-18 12:00:00">2023-10-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/15/%E6%95%A3%E8%A8%98-10-14-23/" title="论文笔记:Tracer:Signature-based Static Analysis for Detecting Recurring Vulnerabilities"><img src="https://i.imgs.ovh/2023/10/13/XDJVK.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="论文笔记:Tracer:Signature-based Static Analysis for Detecting Recurring Vulnerabilities"/></a><div class="content"><a class="title" href="/2023/10/15/%E6%95%A3%E8%A8%98-10-14-23/" title="论文笔记:Tracer:Signature-based Static Analysis for Detecting Recurring Vulnerabilities">论文笔记:Tracer:Signature-based Static Analysis for Detecting Recurring Vulnerabilities</a><time datetime="2023-10-15T04:00:00.000Z" title="发表于 2023-10-15 12:00:00">2023-10-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/14/%E6%95%A3%E8%A8%98-10-13-23/" title="散記"><img src="https://i.imgs.ovh/2023/10/15/r3Uw2.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="散記"/></a><div class="content"><a class="title" href="/2023/10/14/%E6%95%A3%E8%A8%98-10-13-23/" title="散記">散記</a><time datetime="2023-10-14T04:00:00.000Z" title="发表于 2023-10-14 12:00:00">2023-10-14</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DX12/"><span class="card-category-list-name">DX12</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/HGAME/"><span class="card-category-list-name">HGAME</span><span class="card-category-list-count">6</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/HGAME/%E7%95%99%E5%9D%91/"><span class="card-category-list-name">留坑</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Notes/"><span class="card-category-list-name">Notes</span><span class="card-category-list-count">17</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Notes/Paper/"><span class="card-category-list-name">Paper</span><span class="card-category-list-count">4</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Windbg/"><span class="card-category-list-name">Windbg</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Windbg/Anti-debug/"><span class="card-category-list-name">Anti-debug</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Windows/"><span class="card-category-list-name">Windows</span><span class="card-category-list-count">3</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/windbg/" style="font-size: 1.1em; color: #999">windbg</a> <a href="/tags/Dynamic-Programming/" style="font-size: 1.1em; color: #999">Dynamic Programming</a> <a href="/tags/call-convention/" style="font-size: 1.1em; color: #999">call convention</a> <a href="/tags/Hacking/" style="font-size: 1.1em; color: #999">Hacking</a> <a href="/tags/Algorithm/" style="font-size: 1.1em; color: #999">Algorithm</a> <a href="/tags/Static-Analysis/" style="font-size: 1.27em; color: #99a0a9">Static Analysis</a> <a href="/tags/book/" style="font-size: 1.1em; color: #999">book</a> <a href="/tags/mark/" style="font-size: 1.1em; color: #999">mark</a> <a href="/tags/ISA/" style="font-size: 1.1em; color: #999">ISA</a> <a href="/tags/DLL-hook/" style="font-size: 1.1em; color: #999">DLL hook</a> <a href="/tags/vulnerability-mining/" style="font-size: 1.21em; color: #999ea4">vulnerability mining</a> <a href="/tags/Handle/" style="font-size: 1.1em; color: #999">Handle</a> <a href="/tags/anti-debug/" style="font-size: 1.1em; color: #999">anti-debug</a> <a href="/tags/RCTF/" style="font-size: 1.1em; color: #999">RCTF</a> <a href="/tags/%E6%8A%BD%E8%B1%A1%E5%9F%9F/" style="font-size: 1.1em; color: #999">抽象域</a> <a href="/tags/HGAME/" style="font-size: 1.33em; color: #99a2af">HGAME</a> <a href="/tags/directX-12/" style="font-size: 1.16em; color: #999b9e">directX 12</a> <a href="/tags/angr/" style="font-size: 1.16em; color: #999b9e">angr</a> <a href="/tags/paper/" style="font-size: 1.33em; color: #99a2af">paper</a> <a href="/tags/%E7%95%99%E5%9D%91/" style="font-size: 1.16em; color: #999b9e">留坑</a> <a href="/tags/%E6%8A%BD%E8%B1%A1%E8%A7%A3%E9%87%8A/" style="font-size: 1.1em; color: #999">抽象解释</a> <a href="/tags/project/" style="font-size: 1.1em; color: #999">project</a> <a href="/tags/MSVC/" style="font-size: 1.1em; color: #999">MSVC</a> <a href="/tags/LLVM/" style="font-size: 1.44em; color: #99a7ba">LLVM</a> <a href="/tags/WP/" style="font-size: 1.39em; color: #99a4b4">WP</a> <a href="/tags/Grammar/" style="font-size: 1.1em; color: #999">Grammar</a> <a href="/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/" style="font-size: 1.16em; color: #999b9e">图形学</a> <a href="/tags/%E6%95%B0%E5%80%BC%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/" style="font-size: 1.1em; color: #999">数值程序分析</a> <a href="/tags/English/" style="font-size: 1.1em; color: #999">English</a> <a href="/tags/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C/" style="font-size: 1.16em; color: #999b9e">符号执行</a> <a href="/tags/Windows/" style="font-size: 1.16em; color: #999b9e">Windows</a> <a href="/tags/Notes/" style="font-size: 1.5em; color: #99a9bf">Notes</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">十月 2023</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">九月 2023</span><span class="card-archive-list-count">9</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/04/"><span class="card-archive-list-date">四月 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/03/"><span class="card-archive-list-date">三月 2022</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/12/"><span class="card-archive-list-date">十二月 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/08/"><span class="card-archive-list-date">八月 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/07/"><span class="card-archive-list-date">七月 2021</span><span class="card-archive-list-count">1</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">36</div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">65k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-11-20T10:39:49.233Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://i.imgs.ovh/2023/10/13/XDSgm.jpeg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By RT</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>